<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>คู่มือปฏิบัติการฉบับสมบูรณ์: Mastery Goal Automation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body { font-family: 'Kanit', sans-serif; background-color: #f8f9fa; }
        .header-bg { background-image: linear-gradient(135deg, #2b3a42 0%, #4a5d6b 100%); }
        .chapter-title { color: #0072ff; font-weight: 800; border-bottom: 3px solid #0072ff; padding-bottom: 0.5rem; margin-top: 2rem; }
        .step-card { box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08); transition: transform 0.2s; border-radius: 1rem; }
        .step-title { font-weight: 700; color: #1f2937; }
        .code-container { background-color: #eef2ff; border-left: 5px solid #4f46e5; overflow-x: auto; font-family: monospace; padding: 1rem; border-radius: 0.5rem; }
        .action-button { background-image: linear-gradient(45deg, #10b981 0%, #065f46 100%); transition: opacity 0.2s; }
        .image-placeholder { border: 2px dashed #a1a1aa; padding: 1rem; text-align: center; color: #525252; background-color: #fafafa; margin-top: 1rem; border-radius: 0.5rem; }
    </style>
</head>
<body class="text-gray-800">

    <!-- Header -->
    <header class="header-bg text-white py-16 rounded-b-2xl shadow-xl">
        <div class="max-w-7xl mx-auto px-6 text-center">
            <h1 class="text-4xl md:text-6xl font-extrabold mb-3">Mastery Goal Quiz Automation Handbook</h1>
            <p class="text-xl md:text-2xl font-light opacity-90">สร้างระบบอัตโนมัติครบวงจร: Primary Key, Notification และ AppSheet Integration</p>
            <div class="mt-4 flex justify-center space-x-4 text-2xl">
                <i class="fab fa-google text-yellow-400"></i>
                <i class="fab fa-google-drive text-red-400"></i>
                <i class="fas fa-file-alt text-blue-400"></i>
                <i class="fas fa-table text-green-400"></i>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-6 py-16">
        
        <!-- Chapter 0: ปรัชญาและข้อจำกัด -->
        <h2 class="text-3xl chapter-title"><i class="fas fa-book-open mr-2"></i> บทที่ 0: ปรัชญาและโครงสร้างที่รองรับ</h2>
        
        <div class="p-6 bg-blue-50 border-l-4 border-blue-500 rounded-lg my-6">
            <h3 class="text-2xl font-bold text-blue-800 mb-3"><i class="fas fa-lightbulb mr-2"></i> 0.1 หลักการออกแบบ: Single Page คือคำตอบสุดท้าย</h3>
            <p class="text-gray-700">เพื่อแก้ไขปัญหาความขัดแย้งของ Google Forms เราเลือกใช้โครงสร้าง **Single Page Form (ฟอร์มหน้าเดียว)** เพื่อให้ฟีเจอร์ <strong class="text-red-500">"สลับเปลี่ยนลำดับคำถาม"</strong> ทำงานได้อย่างเสถียร 100% (ฟอร์มต้องไม่มี Section/Page Break)</p>
            <p class="mt-3 text-sm text-gray-600">**สถานะ:** Form ของท่านควรอยู่ในโครงสร้าง **Single Page** แล้ว (ยืนยันจากการที่ท่านสามารถสุ่มคำถามได้)</p>
        </div>

        <!-- Chapter 1: Data Model Setup (GAS Code) -->
        <h2 class="text-3xl chapter-title"><i class="fas fa-code mr-2"></i> บทที่ 1: การวางรากฐานข้อมูลด้วย Apps Script</h2>
        
        <div class="space-y-12 mt-8">
            <!-- Step 1: คัดลอกโค้ด -->
            <div class="step-card bg-white p-8">
                <div class="flex items-start">
                    <div class="text-4xl font-extrabold text-white bg-blue-600 rounded-full w-12 h-12 flex items-center justify-center mr-6">1.1</div>
                    <div class="flex-1">
                        <h3 class="text-2xl step-title mb-3">เปิด Script Editor และคัดลอกโค้ดทั้งหมด</h3>
                        <p class="text-gray-700">ในหน้าแก้ไข Google Form ให้คลิกที่ **ไอคอน 3 จุด** (More) ที่มุมขวาบน แล้วเลือก **Script Editor (โปรแกรมแก้ไขสคริปต์)** เพื่อเปิด Google Apps Script (GAS) Editor</p>
                        
                        <div class="image-placeholder">
                           
                           <p class="mt-2 text-xs">ภาพ: ตำแหน่งของเมนู 'Script Editor' ใน Google Form</p>
                        </div>

                        <p class="text-gray-700 mt-4">คัดลอกโค้ด GAS ด้านล่างนี้ไปวาง **ทับ** เนื้อหาเดิมในไฟล์ <code class="text-red-500">Code.gs</code> ทั้งหมด</p>
                        
                        <!-- GAS Code Block -->
                        <div class="code-container mt-4 p-4 relative">
                            <button onclick="copyCode(this, 'gas-code')" class="action-button text-white px-4 py-2 text-sm rounded-lg mb-2 absolute top-2 right-2 z-10">
                                <i class="fas fa-copy mr-1"></i> คัดลอกโค้ด
                            </button>
                            <pre id="gas-code" class="text-xs overflow-x-auto whitespace-pre-wrap pt-8">
// =================================================================
// 1. GLOBAL CONFIGURATION (ปรับค่าได้ตามต้องการ)
// =================================================================

// กำหนดชื่อชีท (Sheet Name) ที่ใช้รับข้อมูลการตอบกลับจาก Google Form (มักเป็น 'Form Responses 1')
const SHEET_NAME = 'Form Responses 1'; 
// คะแนนเต็มที่ถือว่าเป็น Mastery Goal (ตามโจทย์คือ 10 คะแนน)
const MASTERY_SCORE = 10; 
// คอลัมน์ที่ AppSheet ต้องใช้เป็น Primary Key (PK) และจะไม่ซ้ำกัน
const ID_COLUMN_HEADER = 'ID'; 
// คอลัมน์สำหรับตรวจสอบว่าผู้เรียนได้คะแนนเต็มแล้วหรือไม่ (True/False)
const MASTERED_FLAG_HEADER = 'MASTERED'; 
// คอลัมน์สำหรับแสดงชื่อ-นามสกุลผู้เรียน (ต้องตรงกับหัวข้อคำถามใน Forms)
const NAME_COLUMN_HEADER = 'ชื่อ - นามสกุล / ชื่อผู้เรียน (กรอกเพื่อรับประกาศนียบัตร)'; 

// =================================================================
// 2. SETUP FUNCTIONS (ต้องรันด้วยมือเพียงครั้งเดียว)
// =================================================================

/**
 * [STEP 1.2: รันเพื่อติดตั้ง] รันฟังก์ชันนี้ครั้งเดียวเพื่อตั้งค่า Header ใน Google Sheet
 * - สร้างคอลัมน์ ID (PK) และ MASTERED FLAG
 */
function setupSheetHeaders() {
  // ... (Code as previously provided for setupSheetHeaders)
  try {
    const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(SHEET_NAME);
    if (!sheet) {
      Logger.log(`Error: ไม่พบชีทชื่อ ${SHEET_NAME}`);
      return;
    }

    const headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
    
    // หาตำแหน่งที่ถูกต้องสำหรับคอลัมน์ ID: หลัง Timestamp (คอลัมน์ A)
    const pkColumnIndex = 1; // 0-based index (Column B)

    let newHeaders = [...headers];
    let sheetUpdated = false;

    // 1. สร้างคอลัมน์ ID (PK)
    if (newHeaders[pkColumnIndex] !== ID_COLUMN_HEADER) {
      newHeaders.splice(pkColumnIndex, 0, ID_COLUMN_HEADER);
      sheetUpdated = true;
    }
    
    // 2. สร้างคอลัมน์ MASTERED FLAG
    if (newHeaders.indexOf(MASTERED_FLAG_HEADER) === -1) {
      newHeaders.push(MASTERED_FLAG_HEADER);
      sheetUpdated = true;
    }

    if (sheetUpdated) {
      // เขียน Headers ใหม่กลับไปยัง Sheet
      sheet.getRange(1, 1, 1, newHeaders.length).setValues([newHeaders]);
      Logger.log(`✅ Setup Headers สำเร็จ: เพิ่มคอลัมน์ ${ID_COLUMN_HEADER} และ ${MASTERED_FLAG_HEADER}`);
    } else {
      Logger.log(`✅ Setup Headers: คอลัมน์ ${ID_COLUMN_HEADER} และ ${MASTERED_FLAG_HEADER} มีอยู่แล้ว`);
    }
    
    // ตั้งค่า Confirmation Message ด้วย
    setMasteryGoalConfirmation();
    
  } catch (e) {
    Logger.log(`❌ Error ใน setupSheetHeaders: ${e.toString()}`);
  }
}

/**
 * [STEP 2.1: ถูกเรียกด้วย Trigger] ฟังก์ชันหลักที่ทำงานทุกครั้งที่มีการส่ง Form
 * - จัดการการสร้าง PK, ตรวจสอบคะแนน และส่ง Email Notification
 */
function handleFormSubmission(e) {
  // ... (Code as previously provided for handleFormSubmission)
  try {
    const sheet = e.source.getActiveSheet();
    const range = e.range;
    const row = range.getRow();
    const headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];

    // 1. Find Column Indexes
    const pkCol = headers.indexOf(ID_COLUMN_HEADER) + 1; // Column B
    const scoreCol = headers.indexOf('Score') + 1; 
    const masteredCol = headers.indexOf(MASTERED_FLAG_HEADER) + 1;
    const nameCol = headers.indexOf(NAME_COLUMN_HEADER) + 1;
    const emailCol = headers.indexOf('Username') + 1; // Email Column (if collected)
    
    if (pkCol === 0 || scoreCol === 0 || masteredCol === 0) {
      Logger.log('❌ Error: ไม่พบคอลัมน์ที่จำเป็น (ID, Score, MASTERED FLAG)');
      return;
    }

    // 2. Auto-PK Generation (Primary Key)
    let nextId = 1;
    if (row > 2) { 
        const lastId = sheet.getRange(row - 1, pkCol).getValue();
        if (typeof lastId === 'number' && lastId) {
             nextId = lastId + 1;
        }
    }
    
    sheet.getRange(row, pkCol).setValue(nextId);

    // 3. Mastery Goal Check & Flag
    const currentScore = sheet.getRange(row, scoreCol).getValue();
    const isMastered = (currentScore === MASTERY_SCORE);
    sheet.getRange(row, masteredCol).setValue(isMastered);

    // 4. Automated Notification (Email)
    if (isMastered) {
      const studentName = sheet.getRange(row, nameCol).getValue() || 'ผู้เรียน';
      const recipientEmail = sheet.getRange(row, emailCol).getValue();
      
      if (recipientEmail && recipientEmail.includes('@')) {
        sendCongratulatoryEmail(recipientEmail, studentName);
        Logger.log(`✅ Mastery Goal Reached! ส่ง Email แสดงความยินดีไปที่ ${recipientEmail}`);
      } else {
         Logger.log(`⚠️ ไม่สามารถส่ง Email ได้: ไม่พบอีเมลผู้เรียนใน Sheet`);
      }
    }

  } catch (e) {
    Logger.log(`❌ Error ใน handleFormSubmission: ${e.toString()}`);
  }
}

/**
 * ฟังก์ชันสำหรับส่งอีเมลแสดงความยินดี
 */
function sendCongratulatoryEmail(recipient, studentName) {
  const subject = `🎉 ยินดีด้วย! ${studentName} บรรลุ Mastery Goal แล้ว!`;
  const body = `เรียน ${studentName} ...`;

  MailApp.sendEmail({
    to: recipient,
    subject: subject,
    htmlBody: body
  });
}

/**
 * อัปเดตข้อความยืนยันการส่งของ Form ให้มีลิงก์ทำซ้ำ (Utility Function)
 */
function setMasteryGoalConfirmation() {
  const form = FormApp.getActiveForm(); 
  if (!form) { return; }
  
  const formUrl = form.getPublishedUrl();
  const retryUrl = formUrl + '?usp=pp_url';

  const confirmationMessage = `✅ ส่งแบบทดสอบสำเร็จแล้ว! (Mastery Goal Quiz)\n\n🎯 เป้าหมายคือ 10/10 หากยังไม่ได้คะแนนเต็ม คุณสามารถคลิกที่ลิงก์นี้เพื่อทำซ้ำได้ทันที (คำถาม/ตัวเลือกจะถูกสุ่มใหม่): \n\n${retryUrl}`;

  form.setConfirmationMessage(confirmationMessage);
  Logger.log('Confirmation Message Updated successfully.');
}
</pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 2: รัน Setup Header -->
            <div class="step-card bg-white p-8">
                <div class="flex items-start">
                    <div class="text-4xl font-extrabold text-white bg-blue-600 rounded-full w-12 h-12 flex items-center justify-center mr-6">1.2</div>
                    <div class="flex-1">
                        <h3 class="text-2xl step-title mb-3">รันฟังก์ชันติดตั้ง: <code class="text-blue-600">setupSheetHeaders()</code></h3>
                        <p class="text-gray-700">ใน Apps Script Editor: เลือกฟังก์ชัน **<code class="text-blue-600">setupSheetHeaders</code>** จากเมนูรัน (Run Menu) ด้านบน แล้วคลิก **Run** (<i class="fas fa-play text-green-600"></i>)</p>
                        
                         <div class="image-placeholder">
                           
                           <p class="mt-2 text-xs">ภาพ: ตำแหน่งการเลือกฟังก์ชันและปุ่มเรียกใช้</p>
                         </div>

                        <p class="mt-4 text-sm text-gray-700 bg-yellow-100 p-3 rounded-lg border border-yellow-300">
                            **⚠️ การให้สิทธิ์ (Authorization):** ในการรันครั้งแรก ระบบจะขอสิทธิ์เข้าถึง Google Sheets และ Forms โปรดกดยอมรับทุกครั้ง<br>
                            **🎉 ผลลัพธ์:** เมื่อรันเสร็จสิ้น ให้ไปตรวจสอบ Google Sheet ของท่าน ท่านจะเห็นคอลัมน์ <strong class="text-red-500">ID</strong> และ <strong class="text-red-500">MASTERED</strong> ถูกเพิ่มที่แถว Header
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chapter 2: Automation Trigger Setup -->
        <h2 class="text-3xl chapter-title"><i class="fas fa-clock mr-2"></i> บทที่ 2: ตั้งค่า Trigger (ระบบเรียกใช้โค้ดอัตโนมัติ)</h2>
        
        <div class="space-y-12 mt-8">
            <!-- Step 3: ติดตั้ง Trigger -->
            <div class="step-card bg-white p-8">
                <div class="flex items-start">
                    <div class="text-4xl font-extrabold text-white bg-blue-600 rounded-full w-12 h-12 flex items-center justify-center mr-6">2.1</div>
                    <div class="flex-1">
                        <h3 class="text-2xl step-title mb-3">การสร้าง Trigger สำหรับ <code class="text-blue-600">handleFormSubmission()</code></h3>
                        <p class="text-gray-700">Trigger คือตัวกระตุ้นให้โค้ดทำงานโดยอัตโนมัติ ใน Apps Script Editor ให้คลิกที่ **ไอคอนนาฬิกา (Triggers)** <i class="fas fa-clock text-blue-500"></i> ทางด้านซ้าย และคลิก **+ Add Trigger**</p>
                        
                        <div class="image-placeholder">
                           
                           <p class="mt-2 text-xs">ภาพ: ตัวอย่างการตั้งค่า Trigger ใน Apps Script</p>
                        </div>
                        
                        <p class="mt-4 text-gray-700 font-semibold">กรุณาตั้งค่าตามรายละเอียดที่ระบุไว้ในตารางด้านล่างนี้ และกด Save:</p>
                        
                        <table class="w-full text-sm text-left text-gray-700 border-collapse mt-3">
                            <thead>
                                <tr class="bg-blue-100/50 text-blue-800">
                                    <th scope="col" class="py-3 px-4 border-b">การตั้งค่า (Setting)</th>
                                    <th scope="col" class="py-3 px-4 border-b">ค่าที่ต้องเลือก (Value)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b hover:bg-gray-50">
                                    <td class="py-2 px-4">Choose function to run</td>
                                    <td class="py-2 px-4"><code class="font-bold text-green-700">handleFormSubmission</code></td>
                                </tr>
                                <tr class="border-b hover:bg-gray-50">
                                    <td class="py-2 px-4">Select event source</td>
                                    <td class="py-2 px-4"><code class="font-bold text-green-700">From spreadsheet</code></td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="py-2 px-4">Select event type</td>
                                    <td class="py-2 px-4"><code class="font-bold text-green-700">On form submit</code></td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="mt-4 text-sm text-gray-500"><i class="fas fa-bolt mr-1"></i> เมื่อตั้งค่าเสร็จสิ้น ทุกครั้งที่มีผู้เรียนส่ง Form ระบบจะทำงานอัตโนมัติทันที</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chapter 3: AppSheet Integration -->
        <h2 class="text-3xl chapter-title"><i class="fas fa-tablet-alt mr-2"></i> บทที่ 3: การเชื่อมต่อกับ AppSheet (Data Modeling)</h2>
        
        <div class="space-y-12 mt-8">
            <!-- Step 4: AppSheet Integration -->
            <div class="step-card bg-white p-8">
                <div class="flex items-start">
                    <div class="text-4xl font-extrabold text-white bg-blue-600 rounded-full w-12 h-12 flex items-center justify-center mr-6">3.1</div>
                    <div class="flex-1">
                        <h3 class="text-2xl step-title mb-3">หลักการ Primary Key (PK) และการสร้าง App</h3>
                        <p class="text-gray-700">การมีคอลัมน์ <strong class="text-red-500">ID</strong> ที่ไม่ซ้ำกัน (Generated โดย GAS) คือกุญแจสำคัญในการทำ AppSheet เนื่องจาก AppSheet ต้องการ Primary Key เพื่อระบุแถวข้อมูลได้อย่างแม่นยำ</p>

                        <div class="p-4 bg-green-50 border-l-4 border-green-500 rounded-lg my-4">
                            <i class="fas fa-key text-green-600 mr-2"></i> **ทำไมต้อง ID?**: AppSheet ใช้คอลัมน์นี้ในการอัปเดต/ลบข้อมูลเฉพาะแถวนั้นๆ หากไม่มี PK ที่ชัดเจน AppSheet จะคาดเดาจากคอลัมน์อื่น ซึ่งอาจผิดพลาดได้
                        </div>

                        <p class="text-gray-700 mt-4">**ขั้นตอนการสร้าง AppSheet:**</p>
                        <ul class="list-decimal list-inside space-y-3 text-gray-700 ml-4">
                            <li>ไปที่ **AppSheet Homepage:** <a href="https://www.appsheet.com/start/sign-in" target="_blank" class="text-blue-600 hover:underline font-semibold">https://www.appsheet.com/start/sign-in</a></li>
                            <li>คลิก **'Start for free'** หรือ **'My apps'** เพื่อเข้าสู่ระบบ</li>
                            <li>คลิก **'Create'** และเลือก **'App'**</li>
                            <li>เลือก **'Start with your own data'**</li>
                            <li>ในหน้า Data Source ให้เลือก **Google Drive** และเลือก **Google Sheet** ที่เชื่อมต่อกับ Form ของท่าน (Sheet Responses 1)</li>
                        </ul>
                        
                        <div class="image-placeholder">
                           
                           <p class="mt-2 text-xs">ภาพ: การสร้างแอปใหม่และเลือก Google Sheet เป็นแหล่งข้อมูล</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Step 5: AppSheet Column Configuration -->
            <div class="step-card bg-white p-8">
                <div class="flex items-start">
                    <div class="text-4xl font-extrabold text-white bg-blue-600 rounded-full w-12 h-12 flex items-center justify-center mr-6">3.2</div>
                    <div class="flex-1">
                        <h3 class="text-2xl step-title mb-3">การตรวจสอบ Column Type ใน AppSheet</h3>
                        <p class="text-gray-700">หลังจากเชื่อมต่อ Sheet แล้ว AppSheet จะเปิด Column Editor ขึ้นมา ให้ท่านทำการตรวจสอบความถูกต้องของ Type ดังนี้:</p>

                        <table class="w-full text-sm text-left text-gray-700 border-collapse mt-3">
                            <thead>
                                <tr class="bg-blue-100/50 text-blue-800">
                                    <th scope="col" class="py-3 px-4 border-b">คอลัมน์ (Column)</th>
                                    <th scope="col" class="py-3 px-4 border-b">Type ที่ถูกต้อง</th>
                                    <th scope="col" class="py-3 px-4 border-b">การตั้งค่าสำคัญ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b hover:bg-gray-50">
                                    <td class="py-2 px-4"><code class="font-bold text-red-500">ID</code> (PK)</td>
                                    <td class="py-2 px-4">Number</td>
                                    <td class="py-2 px-4"><strong class="text-green-700">Is Key: ✅ (ต้องติ๊ก)</strong></td>
                                </tr>
                                <tr class="border-b hover:bg-gray-50">
                                    <td class="py-2 px-4"><code class="font-bold">Timestamp</code></td>
                                    <td class="py-2 px-4">DateTime</td>
                                    <td class="py-2 px-4">Show: ✅ (แสดง)</td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="py-2 px-4"><code class="font-bold text-red-500">MASTERED</code></td>
                                    <td class="py-2 px-4">Yes/No (Boolean)</td>
                                    <td class="py-2 px-4">Show: ✅ (เพื่อใช้ Filter)</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <div class="image-placeholder">
                           
                           <p class="mt-2 text-xs">ภาพ: การตรวจสอบ Column Type และตั้งค่า 'Is Key' ให้กับคอลัมน์ ID</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chapter 4: Troubleshooting and Conclusion -->
        <h2 class="text-3xl chapter-title"><i class="fas fa-wrench mr-2"></i> บทที่ 4: การแก้ไขปัญหาและการสรุป</h2>

        <div class="space-y-8 mt-8">
            <div class="p-6 bg-red-50 border-l-4 border-red-500 rounded-lg">
                <h3 class="text-xl font-bold text-red-800 mb-3"><i class="fas fa-bug mr-2"></i> การแก้ไขปัญหาที่พบบ่อย (Troubleshooting)</h3>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li>**Error: Cannot find sheet 'Form Responses 1'**: ตรวจสอบว่าชื่อชีทในโค้ด <code class="text-red-500">SHEET_NAME</code> ตรงกับชื่อชีทใน Google Sheet จริงๆ</li>
                    <li>**Permission Denied**: ต้องรันฟังก์ชัน <code class="text-blue-600">setupSheetHeaders</code> ด้วยมืออีกครั้ง เพื่อให้สิทธิ์เข้าถึง Sheets/Forms</li>
                    <li>**ID ไม่เรียง**: หลังรัน setup แล้ว โปรดลองส่ง Form สัก 2-3 ครั้ง โค้ดจะเรียนรู้ ID ล่าสุดและรันต่อจากเลขนั้นได้เอง</li>
                </ul>
            </div>

            <div class="p-6 bg-green-50 border-l-4 border-green-500 rounded-lg">
                <h3 class="text-xl font-bold text-green-800 mb-3"><i class="fas fa-medal mr-2"></i> การสรุปและการประยุกต์ใช้</h3>
                <p class="text-gray-700">ระบบ Automation นี้พร้อมใช้งานแล้ว! ท่านสามารถประยุกต์ใช้คอลัมน์ <strong class="text-red-500">MASTERED</strong> เพื่อทำสิ่งต่างๆ ได้แก่:</p>
                <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4 mt-2">
                    <li>**AppSheet:** สร้าง Slice เพื่อแสดงเฉพาะรายชื่อผู้ที่ **Mastered** เท่านั้น</li>
                    <li>**Looker Studio:** กรองรายงานเพื่อดูสัดส่วนผู้ที่บรรลุเป้าหมาย</li>
                    <li>**GAS:** ใช้เป็นเงื่อนไขในการสร้างและส่งประกาศนียบัตร PDF อัตโนมัติ (เป็น Project ต่อไป)</li>
                </ul>
            </div>
        </div>

    </main>

    <footer class="mt-16 py-6 bg-gray-100 text-center text-gray-600">
        <p>สร้างสรรค์โดย <span class="font-bold">MrTan: คู่หูเขียนโค้ด</span> | โครงการ Mastery Goal Automation | 2025</p>
    </footer>

    <script>
        // JavaScript for copying code to clipboard
        function copyCode(button, targetId) {
            const codeBlock = document.getElementById(targetId);
            const codeText = codeBlock.textContent || codeBlock.innerText;

            const textarea = document.createElement('textarea');
            textarea.value = codeText;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);

            const originalText = button.innerHTML;
            button.innerHTML = '✅ คัดลอกแล้ว!';
            setTimeout(() => {
                button.innerHTML = originalText;
            }, 2000);
        }
    </script>
</body>
</html>
