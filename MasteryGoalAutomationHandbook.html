<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏â‡∏ö‡∏±‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå: Mastery Goal Automation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body { font-family: 'Kanit', sans-serif; background-color: #f8f9fa; }
        .header-bg { background-image: linear-gradient(135deg, #2b3a42 0%, #4a5d6b 100%); }
        .chapter-title { color: #0072ff; font-weight: 800; border-bottom: 3px solid #0072ff; padding-bottom: 0.5rem; margin-top: 2rem; }
        .step-card { box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08); transition: transform 0.2s; border-radius: 1rem; }
        .step-title { font-weight: 700; color: #1f2937; }
        .code-container { background-color: #eef2ff; border-left: 5px solid #4f46e5; overflow-x: auto; font-family: monospace; padding: 1rem; border-radius: 0.5rem; }
        .action-button { background-image: linear-gradient(45deg, #10b981 0%, #065f46 100%); transition: opacity 0.2s; }
        .image-placeholder { border: 2px dashed #a1a1aa; padding: 1rem; text-align: center; color: #525252; background-color: #fafafa; margin-top: 1rem; border-radius: 0.5rem; }
    </style>
</head>
<body class="text-gray-800">

    <!-- Header -->
    <header class="header-bg text-white py-16 rounded-b-2xl shadow-xl">
        <div class="max-w-7xl mx-auto px-6 text-center">
            <h1 class="text-4xl md:text-6xl font-extrabold mb-3">Mastery Goal Quiz Automation Handbook</h1>
            <p class="text-xl md:text-2xl font-light opacity-90">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏Ñ‡∏£‡∏ö‡∏ß‡∏á‡∏à‡∏£: Primary Key, Notification ‡πÅ‡∏•‡∏∞ AppSheet Integration</p>
            <div class="mt-4 flex justify-center space-x-4 text-2xl">
                <i class="fab fa-google text-yellow-400"></i>
                <i class="fab fa-google-drive text-red-400"></i>
                <i class="fas fa-file-alt text-blue-400"></i>
                <i class="fas fa-table text-green-400"></i>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-6 py-16">
        
        <!-- Chapter 0: ‡∏õ‡∏£‡∏±‡∏ä‡∏ç‡∏≤‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î -->
        <h2 class="text-3xl chapter-title"><i class="fas fa-book-open mr-2"></i> ‡∏ö‡∏ó‡∏ó‡∏µ‡πà 0: ‡∏õ‡∏£‡∏±‡∏ä‡∏ç‡∏≤‡πÅ‡∏•‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö</h2>
        
        <div class="p-6 bg-blue-50 border-l-4 border-blue-500 rounded-lg my-6">
            <h3 class="text-2xl font-bold text-blue-800 mb-3"><i class="fas fa-lightbulb mr-2"></i> 0.1 ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö: Single Page ‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢</h3>
            <p class="text-gray-700">‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏±‡∏î‡πÅ‡∏¢‡πâ‡∏á‡∏Ç‡∏≠‡∏á Google Forms ‡πÄ‡∏£‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ä‡πâ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á **Single Page Form (‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå <strong class="text-red-500">"‡∏™‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°"</strong> ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£ 100% (‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ Section/Page Break)</p>
            <p class="mt-3 text-sm text-gray-600">**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:** Form ‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏£‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á **Single Page** ‡πÅ‡∏•‡πâ‡∏ß (‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ó‡πà‡∏≤‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÑ‡∏î‡πâ)</p>
        </div>

        <!-- Chapter 1: Data Model Setup (GAS Code) -->
        <h2 class="text-3xl chapter-title"><i class="fas fa-code mr-2"></i> ‡∏ö‡∏ó‡∏ó‡∏µ‡πà 1: ‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡∏£‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏ß‡∏¢ Apps Script</h2>
        
        <div class="space-y-12 mt-8">
            <!-- Step 1: ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î -->
            <div class="step-card bg-white p-8">
                <div class="flex items-start">
                    <div class="text-4xl font-extrabold text-white bg-blue-600 rounded-full w-12 h-12 flex items-center justify-center mr-6">1.1</div>
                    <div class="flex-1">
                        <h3 class="text-2xl step-title mb-3">‡πÄ‡∏õ‡∏¥‡∏î Script Editor ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                        <p class="text-gray-700">‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Google Form ‡πÉ‡∏´‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà **‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô 3 ‡∏à‡∏∏‡∏î** (More) ‡∏ó‡∏µ‡πà‡∏°‡∏∏‡∏°‡∏Ç‡∏ß‡∏≤‡∏ö‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **Script Editor (‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå)** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î Google Apps Script (GAS) Editor</p>
                        
                        <div class="image-placeholder">
                           
                           <p class="mt-2 text-xs">‡∏†‡∏≤‡∏û: ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏°‡∏ô‡∏π 'Script Editor' ‡πÉ‡∏ô Google Form</p>
                        </div>

                        <p class="text-gray-700 mt-4">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î GAS ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡∏ß‡∏≤‡∏á **‡∏ó‡∏±‡∏ö** ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå <code class="text-red-500">Code.gs</code> ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
                        
                        <!-- GAS Code Block -->
                        <div class="code-container mt-4 p-4 relative">
                            <button onclick="copyCode(this, 'gas-code')" class="action-button text-white px-4 py-2 text-sm rounded-lg mb-2 absolute top-2 right-2 z-10">
                                <i class="fas fa-copy mr-1"></i> ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î
                            </button>
                            <pre id="gas-code" class="text-xs overflow-x-auto whitespace-pre-wrap pt-8">
// =================================================================
// 1. GLOBAL CONFIGURATION (‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)
// =================================================================

// ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏µ‡∏ó (Sheet Name) ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏à‡∏≤‡∏Å Google Form (‡∏°‡∏±‡∏Å‡πÄ‡∏õ‡πá‡∏ô 'Form Responses 1')
const SHEET_NAME = 'Form Responses 1'; 
// ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô Mastery Goal (‡∏ï‡∏≤‡∏°‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏Ñ‡∏∑‡∏≠ 10 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)
const MASTERY_SCORE = 10; 
// ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà AppSheet ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô Primary Key (PK) ‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô
const ID_COLUMN_HEADER = 'ID'; 
// ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà (True/False)
const MASTERED_FLAG_HEADER = 'MASTERED'; 
// ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏ô Forms)
const NAME_COLUMN_HEADER = '‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• / ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô (‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£)'; 

// =================================================================
// 2. SETUP FUNCTIONS (‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)
// =================================================================

/**
 * [STEP 1.2: ‡∏£‡∏±‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á] ‡∏£‡∏±‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Header ‡πÉ‡∏ô Google Sheet
 * - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ID (PK) ‡πÅ‡∏•‡∏∞ MASTERED FLAG
 */
function setupSheetHeaders() {
  // ... (Code as previously provided for setupSheetHeaders)
  try {
    const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(SHEET_NAME);
    if (!sheet) {
      Logger.log(`Error: ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ä‡∏µ‡∏ó‡∏ä‡∏∑‡πà‡∏≠ ${SHEET_NAME}`);
      return;
    }

    const headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
    
    // ‡∏´‡∏≤‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ID: ‡∏´‡∏•‡∏±‡∏á Timestamp (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå A)
    const pkColumnIndex = 1; // 0-based index (Column B)

    let newHeaders = [...headers];
    let sheetUpdated = false;

    // 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ID (PK)
    if (newHeaders[pkColumnIndex] !== ID_COLUMN_HEADER) {
      newHeaders.splice(pkColumnIndex, 0, ID_COLUMN_HEADER);
      sheetUpdated = true;
    }
    
    // 2. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå MASTERED FLAG
    if (newHeaders.indexOf(MASTERED_FLAG_HEADER) === -1) {
      newHeaders.push(MASTERED_FLAG_HEADER);
      sheetUpdated = true;
    }

    if (sheetUpdated) {
      // ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Headers ‡πÉ‡∏´‡∏°‡πà‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á Sheet
      sheet.getRange(1, 1, 1, newHeaders.length).setValues([newHeaders]);
      Logger.log(`‚úÖ Setup Headers ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ${ID_COLUMN_HEADER} ‡πÅ‡∏•‡∏∞ ${MASTERED_FLAG_HEADER}`);
    } else {
      Logger.log(`‚úÖ Setup Headers: ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ${ID_COLUMN_HEADER} ‡πÅ‡∏•‡∏∞ ${MASTERED_FLAG_HEADER} ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß`);
    }
    
    // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Confirmation Message ‡∏î‡πâ‡∏ß‡∏¢
    setMasteryGoalConfirmation();
    
  } catch (e) {
    Logger.log(`‚ùå Error ‡πÉ‡∏ô setupSheetHeaders: ${e.toString()}`);
  }
}

/**
 * [STEP 2.1: ‡∏ñ‡∏π‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡πâ‡∏ß‡∏¢ Trigger] ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á Form
 * - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á PK, ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á Email Notification
 */
function handleFormSubmission(e) {
  // ... (Code as previously provided for handleFormSubmission)
  try {
    const sheet = e.source.getActiveSheet();
    const range = e.range;
    const row = range.getRow();
    const headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];

    // 1. Find Column Indexes
    const pkCol = headers.indexOf(ID_COLUMN_HEADER) + 1; // Column B
    const scoreCol = headers.indexOf('Score') + 1; 
    const masteredCol = headers.indexOf(MASTERED_FLAG_HEADER) + 1;
    const nameCol = headers.indexOf(NAME_COLUMN_HEADER) + 1;
    const emailCol = headers.indexOf('Username') + 1; // Email Column (if collected)
    
    if (pkCol === 0 || scoreCol === 0 || masteredCol === 0) {
      Logger.log('‚ùå Error: ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô (ID, Score, MASTERED FLAG)');
      return;
    }

    // 2. Auto-PK Generation (Primary Key)
    let nextId = 1;
    if (row > 2) { 
        const lastId = sheet.getRange(row - 1, pkCol).getValue();
        if (typeof lastId === 'number' && lastId) {
             nextId = lastId + 1;
        }
    }
    
    sheet.getRange(row, pkCol).setValue(nextId);

    // 3. Mastery Goal Check & Flag
    const currentScore = sheet.getRange(row, scoreCol).getValue();
    const isMastered = (currentScore === MASTERY_SCORE);
    sheet.getRange(row, masteredCol).setValue(isMastered);

    // 4. Automated Notification (Email)
    if (isMastered) {
      const studentName = sheet.getRange(row, nameCol).getValue() || '‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô';
      const recipientEmail = sheet.getRange(row, emailCol).getValue();
      
      if (recipientEmail && recipientEmail.includes('@')) {
        sendCongratulatoryEmail(recipientEmail, studentName);
        Logger.log(`‚úÖ Mastery Goal Reached! ‡∏™‡πà‡∏á Email ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡πÑ‡∏õ‡∏ó‡∏µ‡πà ${recipientEmail}`);
      } else {
         Logger.log(`‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á Email ‡πÑ‡∏î‡πâ: ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô Sheet`);
      }
    }

  } catch (e) {
    Logger.log(`‚ùå Error ‡πÉ‡∏ô handleFormSubmission: ${e.toString()}`);
  }
}

/**
 * ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏¥‡∏ô‡∏î‡∏µ
 */
function sendCongratulatoryEmail(recipient, studentName) {
  const subject = `üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ${studentName} ‡∏ö‡∏£‡∏£‡∏•‡∏∏ Mastery Goal ‡πÅ‡∏•‡πâ‡∏ß!`;
  const body = `‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ${studentName} ...`;

  MailApp.sendEmail({
    to: recipient,
    subject: subject,
    htmlBody: body
  });
}

/**
 * ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡∏≠‡∏á Form ‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏≥‡∏ã‡πâ‡∏≥ (Utility Function)
 */
function setMasteryGoalConfirmation() {
  const form = FormApp.getActiveForm(); 
  if (!form) { return; }
  
  const formUrl = form.getPublishedUrl();
  const retryUrl = formUrl + '?usp=pp_url';

  const confirmationMessage = `‚úÖ ‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß! (Mastery Goal Quiz)\n\nüéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏∑‡∏≠ 10/10 ‡∏´‡∏≤‡∏Å‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ï‡πá‡∏° ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ (‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°/‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏°‡πà): \n\n${retryUrl}`;

  form.setConfirmationMessage(confirmationMessage);
  Logger.log('Confirmation Message Updated successfully.');
}
</pre>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 2: ‡∏£‡∏±‡∏ô Setup Header -->
            <div class="step-card bg-white p-8">
                <div class="flex items-start">
                    <div class="text-4xl font-extrabold text-white bg-blue-600 rounded-full w-12 h-12 flex items-center justify-center mr-6">1.2</div>
                    <div class="flex-1">
                        <h3 class="text-2xl step-title mb-3">‡∏£‡∏±‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á: <code class="text-blue-600">setupSheetHeaders()</code></h3>
                        <p class="text-gray-700">‡πÉ‡∏ô Apps Script Editor: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô **<code class="text-blue-600">setupSheetHeaders</code>** ‡∏à‡∏≤‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡∏£‡∏±‡∏ô (Run Menu) ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏•‡∏¥‡∏Å **Run** (<i class="fas fa-play text-green-600"></i>)</p>
                        
                         <div class="image-placeholder">
                           
                           <p class="mt-2 text-xs">‡∏†‡∏≤‡∏û: ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ</p>
                         </div>

                        <p class="mt-4 text-sm text-gray-700 bg-yellow-100 p-3 rounded-lg border border-yellow-300">
                            **‚ö†Ô∏è ‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå (Authorization):** ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Ç‡∏≠‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á Google Sheets ‡πÅ‡∏•‡∏∞ Forms ‡πÇ‡∏õ‡∏£‡∏î‡∏Å‡∏î‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á<br>
                            **üéâ ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:** ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô ‡πÉ‡∏´‡πâ‡πÑ‡∏õ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Google Sheet ‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô ‡∏ó‡πà‡∏≤‡∏ô‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå <strong class="text-red-500">ID</strong> ‡πÅ‡∏•‡∏∞ <strong class="text-red-500">MASTERED</strong> ‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß Header
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chapter 2: Automation Trigger Setup -->
        <h2 class="text-3xl chapter-title"><i class="fas fa-clock mr-2"></i> ‡∏ö‡∏ó‡∏ó‡∏µ‡πà 2: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Trigger (‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</h2>
        
        <div class="space-y-12 mt-8">
            <!-- Step 3: ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Trigger -->
            <div class="step-card bg-white p-8">
                <div class="flex items-start">
                    <div class="text-4xl font-extrabold text-white bg-blue-600 rounded-full w-12 h-12 flex items-center justify-center mr-6">2.1</div>
                    <div class="flex-1">
                        <h3 class="text-2xl step-title mb-3">‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Trigger ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö <code class="text-blue-600">handleFormSubmission()</code></h3>
                        <p class="text-gray-700">Trigger ‡∏Ñ‡∏∑‡∏≠‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÉ‡∏ô Apps Script Editor ‡πÉ‡∏´‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà **‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤ (Triggers)** <i class="fas fa-clock text-blue-500"></i> ‡∏ó‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏ã‡πâ‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏•‡∏¥‡∏Å **+ Add Trigger**</p>
                        
                        <div class="image-placeholder">
                           
                           <p class="mt-2 text-xs">‡∏†‡∏≤‡∏û: ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Trigger ‡πÉ‡∏ô Apps Script</p>
                        </div>
                        
                        <p class="mt-4 text-gray-700 font-semibold">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ ‡πÅ‡∏•‡∏∞‡∏Å‡∏î Save:</p>
                        
                        <table class="w-full text-sm text-left text-gray-700 border-collapse mt-3">
                            <thead>
                                <tr class="bg-blue-100/50 text-blue-800">
                                    <th scope="col" class="py-3 px-4 border-b">‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ (Setting)</th>
                                    <th scope="col" class="py-3 px-4 border-b">‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (Value)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b hover:bg-gray-50">
                                    <td class="py-2 px-4">Choose function to run</td>
                                    <td class="py-2 px-4"><code class="font-bold text-green-700">handleFormSubmission</code></td>
                                </tr>
                                <tr class="border-b hover:bg-gray-50">
                                    <td class="py-2 px-4">Select event source</td>
                                    <td class="py-2 px-4"><code class="font-bold text-green-700">From spreadsheet</code></td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="py-2 px-4">Select event type</td>
                                    <td class="py-2 px-4"><code class="font-bold text-green-700">On form submit</code></td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="mt-4 text-sm text-gray-500"><i class="fas fa-bolt mr-1"></i> ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡πà‡∏á Form ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chapter 3: AppSheet Integration -->
        <h2 class="text-3xl chapter-title"><i class="fas fa-tablet-alt mr-2"></i> ‡∏ö‡∏ó‡∏ó‡∏µ‡πà 3: ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö AppSheet (Data Modeling)</h2>
        
        <div class="space-y-12 mt-8">
            <!-- Step 4: AppSheet Integration -->
            <div class="step-card bg-white p-8">
                <div class="flex items-start">
                    <div class="text-4xl font-extrabold text-white bg-blue-600 rounded-full w-12 h-12 flex items-center justify-center mr-6">3.1</div>
                    <div class="flex-1">
                        <h3 class="text-2xl step-title mb-3">‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£ Primary Key (PK) ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á App</h3>
                        <p class="text-gray-700">‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå <strong class="text-red-500">ID</strong> ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô (Generated ‡πÇ‡∏î‡∏¢ GAS) ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏∏‡∏ç‡πÅ‡∏à‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ AppSheet ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å AppSheet ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ Primary Key ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏∏‡πÅ‡∏ñ‡∏ß‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥</p>

                        <div class="p-4 bg-green-50 border-l-4 border-green-500 rounded-lg my-4">
                            <i class="fas fa-key text-green-600 mr-2"></i> **‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á ID?**: AppSheet ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï/‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÅ‡∏ñ‡∏ß‡∏ô‡∏±‡πâ‡∏ô‡πÜ ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏°‡∏µ PK ‡∏ó‡∏µ‡πà‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô AppSheet ‡∏à‡∏∞‡∏Ñ‡∏≤‡∏î‡πÄ‡∏î‡∏≤‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏≠‡∏∑‡πà‡∏ô ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡∏≤‡∏à‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÑ‡∏î‡πâ
                        </div>

                        <p class="text-gray-700 mt-4">**‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á AppSheet:**</p>
                        <ul class="list-decimal list-inside space-y-3 text-gray-700 ml-4">
                            <li>‡πÑ‡∏õ‡∏ó‡∏µ‡πà **AppSheet Homepage:** <a href="https://www.appsheet.com/start/sign-in" target="_blank" class="text-blue-600 hover:underline font-semibold">https://www.appsheet.com/start/sign-in</a></li>
                            <li>‡∏Ñ‡∏•‡∏¥‡∏Å **'Start for free'** ‡∏´‡∏£‡∏∑‡∏≠ **'My apps'** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</li>
                            <li>‡∏Ñ‡∏•‡∏¥‡∏Å **'Create'** ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **'App'**</li>
                            <li>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **'Start with your own data'**</li>
                            <li>‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Data Source ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **Google Drive** ‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **Google Sheet** ‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Form ‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô (Sheet Responses 1)</li>
                        </ul>
                        
                        <div class="image-placeholder">
                           
                           <p class="mt-2 text-xs">‡∏†‡∏≤‡∏û: ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏≠‡∏õ‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Google Sheet ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏´‡∏•‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Step 5: AppSheet Column Configuration -->
            <div class="step-card bg-white p-8">
                <div class="flex items-start">
                    <div class="text-4xl font-extrabold text-white bg-blue-600 rounded-full w-12 h-12 flex items-center justify-center mr-6">3.2</div>
                    <div class="flex-1">
                        <h3 class="text-2xl step-title mb-3">‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Column Type ‡πÉ‡∏ô AppSheet</h3>
                        <p class="text-gray-700">‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Sheet ‡πÅ‡∏•‡πâ‡∏ß AppSheet ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î Column Editor ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤ ‡πÉ‡∏´‡πâ‡∏ó‡πà‡∏≤‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á Type ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:</p>

                        <table class="w-full text-sm text-left text-gray-700 border-collapse mt-3">
                            <thead>
                                <tr class="bg-blue-100/50 text-blue-800">
                                    <th scope="col" class="py-3 px-4 border-b">‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå (Column)</th>
                                    <th scope="col" class="py-3 px-4 border-b">Type ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</th>
                                    <th scope="col" class="py-3 px-4 border-b">‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="border-b hover:bg-gray-50">
                                    <td class="py-2 px-4"><code class="font-bold text-red-500">ID</code> (PK)</td>
                                    <td class="py-2 px-4">Number</td>
                                    <td class="py-2 px-4"><strong class="text-green-700">Is Key: ‚úÖ (‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡πä‡∏Å)</strong></td>
                                </tr>
                                <tr class="border-b hover:bg-gray-50">
                                    <td class="py-2 px-4"><code class="font-bold">Timestamp</code></td>
                                    <td class="py-2 px-4">DateTime</td>
                                    <td class="py-2 px-4">Show: ‚úÖ (‡πÅ‡∏™‡∏î‡∏á)</td>
                                </tr>
                                <tr class="hover:bg-gray-50">
                                    <td class="py-2 px-4"><code class="font-bold text-red-500">MASTERED</code></td>
                                    <td class="py-2 px-4">Yes/No (Boolean)</td>
                                    <td class="py-2 px-4">Show: ‚úÖ (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ Filter)</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <div class="image-placeholder">
                           
                           <p class="mt-2 text-xs">‡∏†‡∏≤‡∏û: ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Column Type ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ 'Is Key' ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ID</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chapter 4: Troubleshooting and Conclusion -->
        <h2 class="text-3xl chapter-title"><i class="fas fa-wrench mr-2"></i> ‡∏ö‡∏ó‡∏ó‡∏µ‡πà 4: ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏£‡∏∏‡∏õ</h2>

        <div class="space-y-8 mt-8">
            <div class="p-6 bg-red-50 border-l-4 border-red-500 rounded-lg">
                <h3 class="text-xl font-bold text-red-800 mb-3"><i class="fas fa-bug mr-2"></i> ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢ (Troubleshooting)</h3>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                    <li>**Error: Cannot find sheet 'Form Responses 1'**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏µ‡∏ó‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î <code class="text-red-500">SHEET_NAME</code> ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏µ‡∏ó‡πÉ‡∏ô Google Sheet ‡∏à‡∏£‡∏¥‡∏á‡πÜ</li>
                    <li>**Permission Denied**: ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô <code class="text-blue-600">setupSheetHeaders</code> ‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á Sheets/Forms</li>
                    <li>**ID ‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏á**: ‡∏´‡∏•‡∏±‡∏á‡∏£‡∏±‡∏ô setup ‡πÅ‡∏•‡πâ‡∏ß ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡∏™‡πà‡∏á Form ‡∏™‡∏±‡∏Å 2-3 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á ‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ ID ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ô‡∏ï‡πà‡∏≠‡∏à‡∏≤‡∏Å‡πÄ‡∏•‡∏Ç‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏≠‡∏á</li>
                </ul>
            </div>

            <div class="p-6 bg-green-50 border-l-4 border-green-500 rounded-lg">
                <h3 class="text-xl font-bold text-green-800 mb-3"><i class="fas fa-medal mr-2"></i> ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ</h3>
                <p class="text-gray-700">‡∏£‡∏∞‡∏ö‡∏ö Automation ‡∏ô‡∏µ‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß! ‡∏ó‡πà‡∏≤‡∏ô‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏Å‡∏ï‡πå‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå <strong class="text-red-500">MASTERED</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏™‡∏¥‡πà‡∏á‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πà:</p>
                <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4 mt-2">
                    <li>**AppSheet:** ‡∏™‡∏£‡πâ‡∏≤‡∏á Slice ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà **Mastered** ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</li>
                    <li>**Looker Studio:** ‡∏Å‡∏£‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏ö‡∏£‡∏£‡∏•‡∏∏‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢</li>
                    <li>**GAS:** ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏ô‡∏µ‡∏¢‡∏ö‡∏±‡∏ï‡∏£ PDF ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡πÄ‡∏õ‡πá‡∏ô Project ‡∏ï‡πà‡∏≠‡πÑ‡∏õ)</li>
                </ul>
            </div>
        </div>

    </main>

    <footer class="mt-16 py-6 bg-gray-100 text-center text-gray-600">
        <p>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå‡πÇ‡∏î‡∏¢ <span class="font-bold">MrTan: ‡∏Ñ‡∏π‡πà‡∏´‡∏π‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î</span> | ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ Mastery Goal Automation | 2025</p>
    </footer>

    <script>
        // JavaScript for copying code to clipboard
        function copyCode(button, targetId) {
            const codeBlock = document.getElementById(targetId);
            const codeText = codeBlock.textContent || codeBlock.innerText;

            const textarea = document.createElement('textarea');
            textarea.value = codeText;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);

            const originalText = button.innerHTML;
            button.innerHTML = '‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!';
            setTimeout(() => {
                button.innerHTML = originalText;
            }, 2000);
        }
    </script>
</body>
</html>
