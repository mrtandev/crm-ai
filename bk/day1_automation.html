<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Day 1: ปรัชญา No-Code & Data Design</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Noto+Sans+Thai:wght@100..900&display=swap');
        :root {
            --primary-color: #3b82f6; /* Blue-500 */
            --gradient-start: #3b82f6;
            --gradient-end: #6366f1; /* Indigo-500 */
        }
        body {
            font-family: 'Noto Sans Thai', 'Inter', sans-serif;
            background-color: #f8fafc; /* ใช้สีเดียวกับ Day 2 */
        }
        .gradient-text {
            background-image: linear-gradient(to right, var(--gradient-start), var(--gradient-end));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        .card-shadow {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        /* Custom card style for step-by-step content */
        .step-card {
            border-left: 5px solid #3b82f6;
            transition: all 0.3s ease;
        }
        .step-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transform: translateY(-2px);
        }
        /* Utility for displaying code blocks within the lesson text */
        .code-snippet {
            font-family: monospace;
            background-color: #e2e8f0;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            color: #334155;
            display: inline-block;
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
        }
        pre {
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
    </style>
     <script>
        // Lucide Icons (Placeholder for consistency)
        const renderIcon = (name, className = 'w-5 h-5') => {
            const icons = {
                'users': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><path d="M16 21v-2a4 4 0 0 0 -4 -4H6a4 4 0 0 0 -4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0 -3 -3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>`,
                'database': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M3 5V19A9 3 0 0 0 21 19V5"/><path d="M3 12A9 3 0 0 0 21 12"/></svg>`,
                'blocks': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><rect width="7" height="7" x="3" y="3" rx="1"/><rect width="7" height="7" x="14" y="3" rx="1"/><rect width="7" height="7" x="14" y="14" rx="1"/><rect width="7" height="7" x="3" y="14" rx="1"/></svg>`,
                'code': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>`,
                'arrow-right': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><path d="M5 12h14"/><path d="m12 5 7 7 -7 7"/></svg>`,
                'arrow-down': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><path d="M12 5v14"/><path d="m19 12 -7 7 -7 -7"/></svg>`,
                'star': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>`,
                'coffee': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><path d="M10 2v2c0 1.1.9 2 2 2s2 -.9 2 -2V2"/><path d="M12 10v4c0 1.1.9 2 2 2h2c1.1 0 2 -.9 2 -2V10"/><path d="M3 6h18v4a2 2 0 0 1 -2 2H5a2 2 0 0 1 -2 -2V6Z"/></svg>`,
                'utensils': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><path d="M3 2v7c0 1.1.9 2 2 2h4l-3 9"/><path d="M21 2v7c0 1.1 -.9 2 -2 2h-4l3 9"/><line x1="15" x2="9" y1="11" y2="17"/></svg>`,
                'lightbulb': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><path d="M15 14c.2 -.8 1 -1.4 1.8 -1.4a3 3 0 1 1 0 6h-5.6"/><path d="M4 17a3 3 0 1 0 0 6h10c1.7 0 3 -1.3 3 -3 0 -1.1 -.9 -2 -2 -2"/><path d="M12 3L12 12"/><path d="M12 3a7 7 0 0 0 -7 7 7 7 0 0 0 7 7"/></svg>`,
                'tool': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><path d="M16 10l-4 4 -4 4"/><path d="M10 16l4 -4 4 -4"/></svg>`,
                'git-branch': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><line x1="6" x2="6" y1="3" y2="15"/><circle cx="18" cy="6" r="3"/><circle cx="6" cy="18" r="3"/><path d="M18 9a9 9 0 0 1 -9 9"/></svg>`,
                'brain': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><path d="M9 18C7 16 7 14 7 12s0 -4 2 -6"/><path d="M15 6c2 2 2 4 2 6s0 4 -2 6"/><path d="M17 12A10 10 0 0 0 7 12"/><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10 -4.5 10 -10S17.5 2 12 2Z"/></svg>`,
                'mail': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7 -10 7 -10 -7"/></svg>`,
                'alert-triangle': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><path d="m21.73 18 -9 -15a2 2 0 0 0 -3.46 0l-9 15a2 2 0 0 0 1.73 3h18.54a2 2 0 0 0 1.73 -3Z"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>`,
                'shield': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><path d="M12 22s8 -4 8 -10V5l-8 -3 -8 3v7c0 6 8 10 8 10z"/></svg>`,
                'calendar-check': `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${className}"><path d="M8 2v4"/><path d="M16 2v4"/><rect width="18" height="18" x="3" y="4" rx="2"/><path d="M3 10h18"/><path d="m9 16 2 2 4 -4"/></svg>`,
            };
            return icons[name] || '';
        };

        window.onload = () => {
             // We don't need lucide.createIcons() anymore as we use document.write
             // but we keep the helper function for consistency if the user modifies the code later.
             console.log("Day 1 Handbook Loaded.");
        };

    </script>
</head>
<body class="min-h-screen">
    <!-- Message Box for Alerts/Confirmations -->
    <div id="messageBox" class="fixed top-4 right-4 z-50 w-full max-w-sm"></div>

    <!-- Header Section (Consistent with Day 2) -->
    <header class="bg-white card-shadow sticky top-0 z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center space-x-3">
                    <div class="text-3xl font-extrabold tracking-tight">
                        <span class="gradient-text">AI Automation & Data Integration Master</span>
                    </div>
                </div>
                <div class="mt-2 md:mt-0 text-right text-sm text-gray-600">
                    Day 1: ปรัชญา No-Code & Data Design
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- Instructor Information Card (Consistent with Day 2) -->
        <div class="bg-white p-6 rounded-xl card-shadow mb-8 border-t-4 border-indigo-500">
            <div class="flex items-center space-x-4">
                <img src="https://profile.line-scdn.net/0h0eGDNw66b0pqPX4GcyERNRptbCBJTDZYT190LFluMi9eCyscRwgpL1g_OHpWCHhIEghzeAhqYnNmLhgsdGuTfm0NMntWCy0aQ14hrA" 
                     onerror="this.onerror=null;this.src='https://placehold.co/80x80/6366f1/ffffff?text=อ.แทน'"
                     alt="อาจารย์แทน ธีรชัย โฉมทัพ" class="w-20 h-20 rounded-full object-cover ring-2 ring-indigo-500">
                <div>
                    <h2 class="text-2xl font-bold text-gray-800">อ.แทน <span class="text-indigo-600">[ธีรชัย โฉมทัพ]</span></h2>
                    <p class="text-base text-gray-500">Head of Digital Transformation</p>
                    <p class="text-sm text-gray-600 mt-1">ยินดีต้อนรับสู่ Day 1 เราจะสร้างรากฐานของ Data Design และ Low-Code Automation ที่แข็งแกร่ง!</p>
                </div>
            </div>
        </div>

        <!-- Timetable and Checkboxes (Day 1 Specific Content) -->
        <div class="bg-white p-6 rounded-xl card-shadow mb-8">
            <h3 class="text-2xl font-semibold mb-4 gradient-text">กำหนดการเรียนรู้ Day 1 📚</h3>
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">เวลา</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">หัวข้อ/กิจกรรม</th>
                        <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">สถานะ</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    <!-- 09:00 - 10:30 -->
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">09:00 - 10:15 น.</td>
                        <td class="px-6 py-4 text-sm text-gray-800">หัวข้อ 1.1: นิยามและความแตกต่าง: No-Code vs. Low-Code</td>
                        <td class="px-6 py-4 whitespace-nowrap text-center">
                            <input type="checkbox" class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500" checked>
                        </td>
                    </tr>
                    <!-- 10:30 - 10:45 -->
                    <tr>
                        <td class="px-6 py-2 whitespace-nowrap text-xs text-gray-500 italic">10:15 - 10:30 น.</td>
                        <td class="px-6 py-2 text-xs text-gray-500 italic">พักเบรคเช้า (Coffee Break)</td>
                        <td class="px-6 py-2 whitespace-nowrap text-center">
                            <input type="checkbox" class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                        </td>
                    </tr>
                    <!-- 10:45 - 12:00 -->
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">10:30 - 12:00 น.</td>
                        <td class="px-6 py-4 text-sm text-gray-800">หัวข้อ 1.2: การวิเคราะห์ความต้องการและการเลือกใช้เครื่องมือ (Ecosystem)</td>
                        <td class="px-6 py-4 whitespace-nowrap text-center">
                            <input type="checkbox" class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                        </td>
                    </tr>
                    <!-- 12:00 - 13:00 -->
                    <tr>
                        <td class="px-6 py-2 whitespace-nowrap text-xs text-gray-500 italic">12:00 - 13:00 น.</td>
                        <td class="px-6 py-2 text-xs text-gray-500 italic">พักเที่ยง (Lunch Break)</td>
                        <td class="px-6 py-2 whitespace-nowrap text-center">
                            <input type="checkbox" class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                        </td>
                    </tr>
                    <!-- 13:00 - 14:30 -->
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">13:00 - 14:45 น.</td>
                        <td class="px-6 py-4 text-sm text-gray-800">หัวข้อ 2.1: Data Normalization และ PK/FK ใน Google Sheets (GGS)</td>
                        <td class="px-6 py-4 whitespace-nowrap text-center">
                            <input type="checkbox" class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                        </td>
                    </tr>
                    <!-- 14:30 - 14:45 -->
                    <tr>
                        <td class="px-6 py-2 whitespace-nowrap text-xs text-gray-500 italic">14:45 - 15:00 น.</td>
                        <td class="px-6 py-2 text-xs text-gray-500 italic">พักเบรคบ่าย (Coffee Break)</td>
                        <td class="px-6 py-2 whitespace-nowrap text-center">
                            <input type="checkbox" class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                        </td>
                    </tr>
                    <!-- 14:45 - 16:00 (Workshops) -->
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">15:00 - 16:00 น.</td>
                        <td class="px-6 py-4 text-sm text-gray-800">
                            หัวข้อ 2.2-2.4: Workshop AI-Driven GAS (Auto ID, Email Alert, Data Lookup & Stability)
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-center">
                            <input type="checkbox" class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>


        <!-- *************************************************************** -->
        <!-- ******************** START ORIGINAL CONTENT ********************* -->
        <!-- *************************************************************** -->

        <h3 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-2 flex items-center">
            <script>document.write(renderIcon('calendar-check', 'w-6 h-6 mr-3 text-green-600'));</script> แผนการสอนรายชั่วโมง (Step-by-Step)
        </h3>
        
        <!-- Section 1: Philosophy (09:00 - 12:00) -->
        <div class="mb-8">
            <div class="flex items-center mb-4 p-3 bg-blue-50 rounded-lg">
                <script>document.write(renderIcon('star', 'w-6 h-6 text-yellow-500 mr-3'));</script>
                <h4 class="text-xl font-semibold text-blue-800">ช่วงเช้า: ปรัชญา No-Code/Low-Code (2.25 ชม.)</h4>
            </div>

            <!-- Step 1.1: บทนำ & ทฤษฎี -->
            <div class="step-card bg-white p-5 rounded-lg shadow-md mb-4">
                <div class="flex justify-between items-start mb-2">
                    <span class="text-lg font-bold text-gray-800">09:00 - 10:15 (1.25 ชม.): บทนำ & ทฤษฎี</span>
                    <span class="text-xs font-medium text-blue-500 bg-blue-100 px-2 py-1 rounded-full">ทฤษฎี & แนวคิด</span>
                </div>
                <p class="font-semibold text-gray-700 mb-4">หัวข้อหลัก: ทำความเข้าใจโลกของ No-Code และ Low-Code</p>
                
                <!-- START CSS DIAGRAM: No-Code vs. Low-Code -->
                <div class="my-4 p-5 bg-gray-50 rounded-lg border border-blue-200 shadow-inner">
                    <p class="text-sm font-semibold text-gray-700 mb-3 text-center">ภาพที่ 1.1: เปรียบเทียบ No-Code และ Low-Code (เน้น AppSheet, n8n)</p>
                    <div class="flex flex-col sm:flex-row justify-center items-center space-y-4 sm:space-y-0 sm:space-x-8">
                        
                        <!-- No-Code Box (AppSheet) -->
                        <div class="flex flex-col items-center p-4 w-40 h-40 bg-green-50 rounded-xl shadow-lg border-2 border-green-400">
                            <script>document.write(renderIcon('blocks', 'w-8 h-8 text-green-600 mb-2'));</script>
                            <p class="font-bold text-lg text-green-700">AppSheet</p>
                            <p class="text-xs text-center text-gray-600 mt-2">ผู้ใช้งาน: Citizen Dev</p>
                            <p class="text-xs text-center text-gray-600 font-bold text-green-800">เน้นสร้าง Mobile/Web App</p>
                        </div>

                        <!-- Arrow -->
                        <div class="flex items-center text-blue-500 font-bold text-xl">
                            <script>document.write(renderIcon('arrow-right', 'w-8 h-8 hidden sm:block'));</script>
                            <script>document.write(renderIcon('arrow-down', 'w-8 h-8 sm:hidden'));</script>
                            <span class="text-sm font-medium ml-2 sm:ml-0 sm:mt-2">เชื่อมต่อด้วย...</span>
                        </div>

                        <!-- Low-Code Box (n8n/GAS) -->
                        <div class="flex flex-col items-center p-4 w-40 h-40 bg-indigo-50 rounded-xl shadow-lg border-2 border-indigo-400">
                            <script>document.write(renderIcon('code', 'w-8 h-8 text-indigo-600 mb-2'));</script>
                            <p class="font-bold text-lg text-indigo-700">n8n / GAS</p>
                            <p class="text-xs text-center text-gray-600 mt-2">ผู้ใช้งาน: Pro Dev / IT</p>
                            <p class="text-xs text-center text-gray-600 font-bold text-indigo-800">เน้น Logic & API</p>
                        </div>
                    </div>
                </div>
                <!-- END CSS DIAGRAM -->

                <div class="space-y-4 text-gray-600">
                    <h5 class="font-bold text-lg text-gray-700 mt-6 border-b pb-1">1.1.1 นิยามและความแตกต่าง: No-Code (AppSheet) vs. Low-Code (n8n/GAS)</h5>
                    <p class="ml-4">
                        <span class="font-bold text-green-700">No-Code (Citizen Developers):</span> เครื่องมือที่เน้นความเร็วในการสร้าง **Application Interface** โดยใช้การลากวาง (Drag-and-Drop) และตั้งค่าผ่าน UI เช่น **AppSheet** ซึ่งเหมาะสำหรับงานที่ต้องการ App บนมือถือ หรือ Web Form ที่เชื่อมต่อกับ Google Sheets
                    </p>
                    <p class="ml-4">
                        <span class="font-bold text-indigo-700">Low-Code (Pro-Developers / IT):</span> เครื่องมือที่ให้ความสามารถในการสร้าง **Workflow Logic** ที่ซับซ้อนขึ้น สามารถเขียนโค้ด (JavaScript/GAS) ผสมผสานเข้าไปได้ เพื่อจัดการกับ Data Transformation และการเชื่อมต่อกับระบบภายนอกผ่าน API โดยตรง เช่น **n8n** และ **Google App Script (GAS)**
                    </p>
                    
                    <h5 class="font-bold text-lg text-gray-700 border-b pb-1 mt-6">1.1.2 The 'Why' & 'When': กลยุทธ์การเลือกใช้เครื่องมือ (Depth Analysis)</h5>
                    <p class="ml-4">
                        **Why (เหตุผลที่ต้องทำ Automation):** การใช้ No-Code/Low-Code มีวัตถุประสงค์หลัก 3 ประการคือ 1) ลดเวลาในการพัฒนาระบบ (Time-to-Market) 2) สร้างความยืดหยุ่นในการปรับปรุงกระบวนการ (Agility) และ 3) ลดข้อผิดพลาดที่เกิดจากมนุษย์ (Human Error)
                    </p>
                    <p class="ml-4 font-bold text-indigo-800 pt-2">
                        ตารางเปรียบเทียบเชิงกลยุทธ์ (AppSheet vs. n8n/GAS):
                    </p>
                    <div class="border border-gray-300 rounded-lg overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-blue-50">
                                <tr>
                                    <th class="px-3 py-2 text-left text-xs font-bold text-blue-700 uppercase tracking-wider">เกณฑ์</th>
                                    <th class="px-3 py-2 text-left text-xs font-bold text-green-700 uppercase tracking-wider">AppSheet (No-Code App)</th>
                                    <th class="px-3 py-2 text-left text-xs font-bold text-indigo-700 uppercase tracking-wider">N8N / GAS (Low-Code Logic)</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200 text-sm">
                                <tr>
                                    <td class="px-3 py-2 font-medium">Use Case หลัก</td>
                                    <td class="px-3 py-2">สร้าง App (Data Entry, Report Viewing, CRUD Operations)</td>
                                    <td class="px-3 py-2">Workflow Automation (API Calls, Data Integration, Scheduled Tasks)</td>
                                </tr>
                                <tr>
                                    <td class="px-3 py-2 font-medium">จุดเด่น</td>
                                    <td class="px-3 py-2 text-green-700">เร็วที่สุด, Responsive UI อัตโนมัติ, เน้นผู้ใช้ปลายทาง</td>
                                    <td class="px-3 py-2 text-indigo-700">จัดการ Logic ซับซ้อนได้, เชื่อมต่อระบบภายนอก, ปรับแต่งโค้ดได้</td>
                                </tr>
                                <tr>
                                    <td class="px-3 py-2 font-medium">ข้อจำกัด</td>
                                    <td class="px-3 py-2">จำกัดเรื่อง UI/UX ขั้นสูง, Logic ซับซ้อนทำได้ยาก (Expression Language)</td>
                                    <td class="px-3 py-2">ไม่มี Front-end/UI ในตัว, ต้องสร้าง Interface แยก (เช่น GForms, Apps Script Web App)</td>
                                </tr>
                                <tr>
                                    <td class="px-3 py-2 font-medium">Skill ที่ต้องการ</td>
                                    <td class="px-3 py-2">Data Modeling, AppSheet Expressions</td>
                                    <td class="px-3 py-2">JavaScript/GAS, REST API Concepts, Logic Flow Design</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <h5 class="font-bold text-lg text-gray-700 border-b pb-1 mt-6">1.1.3 The Role of AI in Low-Code / No-Code (แนวคิด AI Agent)</h5>
                    <p class="ml-4">
                        AI เข้ามาเป็นส่วนสำคัญใน Ecosystem นี้ โดยเฉพาะใน **AppSheet** และ **n8n**:
                        <ul class="list-disc list-inside ml-6">
                            <li>**AppSheet:** ใช้ AI ในการวิเคราะห์โครงสร้าง GGS แล้ว **แนะนำประเภทคอลัมน์ (Column Types)** และ **สร้าง App พื้นฐาน** ให้อัตโนมัติ (AI-Powered Development)</li>
                            <li>**n8n:** สามารถใช้ AI Nodes (เช่น OpenAI) เพื่อ **จัดการข้อมูลที่ไม่มีโครงสร้าง (Unstructured Data)** เช่น การสรุป Email, การจำแนกหมวดหมู่ข้อความ, หรือการตรวจสอบความถูกต้องของข้อมูลก่อนนำเข้าสู่ GGS</li>
                            <li>**GAS/Low-Code:** ใช้ AI (เช่น Gemini API ผ่าน GAS) เพื่อเพิ่มความสามารถในการประมวลผลภาษาธรรมชาติ (NLP) ที่ซับซ้อนกว่า Expression Language ของ AppSheet</li>
                        </ul>
                    </p>
                    
                    <h5 class="font-bold text-lg text-gray-700 border-b pb-1 mt-6">1.1.4 Case Studies และกิจกรรมเปิดตัวแพลตฟอร์ม:</h5>
                    <p class="ml-4">
                        **ตัวอย่างการทำงานร่วมกัน (Integrated Workflow):**
                        <ul class="list-disc list-inside ml-6">
                            <li>ผู้ใช้กรอกข้อมูลใน **AppSheet** (App: **No-Code**).</li>
                            <li>ข้อมูลบันทึกลง **Google Sheets (GGS)** (Data Source).</li>
                            <li><span class="font-bold text-indigo-600">GAS (Google App Script)</span> ตรวจสอบข้อมูลใหม่ใน GGS และประมวลผล Logic เฉพาะทาง (Low-Code) เช่น การสร้าง PDF หรือการเรียก API ภายนอก.</li>
                            <li><span class="font-bold text-indigo-600">n8n</span> ถูก Trigger โดย GAS หรือ Webhook เมื่อมีการอัปเดต $\to$ เชื่อมต่อกับ Line API $\to$ ส่ง Line Notify (Low-Code Automation).</li>
                        </ul>
                    </p>
                    
                </div>
                <div class="mt-3 text-sm text-gray-500 italic flex items-center">
                    <script>document.write(renderIcon('lightbulb', 'w-4 h-4 mr-2 text-yellow-500'));</script> จุดเน้น: การวางแผน Ecosystem โดยมอง GGS เป็นศูนย์กลาง และใช้ AppSheet/n8n/GAS เติมเต็มความสามารถซึ่งกันและกัน
                </div>
            </div>

            <!-- Divider for Morning Break -->
            <div class="my-6 text-center">
                <span class="inline-flex items-center justify-center p-3 rounded-full bg-yellow-100 text-yellow-600 font-bold">
                    <script>document.write(renderIcon('coffee', 'w-5 h-5 mr-2'));</script> เบรคเช้า (10:15 - 10:30 น.)
                </span>
            </div>

            <!-- Step 1.2: การเลือกใช้เครื่องมือ -->
            <div class="step-card bg-white p-5 rounded-lg shadow-md mb-4">
                <div class="flex justify-between items-start mb-2">
                    <span class="text-lg font-bold text-gray-800">10:30 - 11:15 (0.75 ชม.): การเลือกใช้เครื่องมือ</span>
                    <span class="text-xs font-medium text-purple-500 bg-purple-100 px-2 py-1 rounded-full">ปฏิบัติ (Discussion)</span>
                </div>
                <p class="font-semibold text-gray-700 mb-4">หัวข้อหลัก: การวิเคราะห์ความต้องการและ Ecosystem</p>
                
                <!-- START CSS DIAGRAM: Tool Selection Matrix -->
                <div class="my-4 p-5 bg-gray-50 rounded-lg border border-purple-200 shadow-inner overflow-x-auto">
                    <p class="text-sm font-semibold text-gray-700 mb-3 text-center">ภาพที่ 1.2: เกณฑ์การเลือกใช้เครื่องมือหลัก (AppSheet, n8n, GGS)</p>
                    <div class="flex flex-col sm:grid sm:grid-cols-3 gap-1 text-sm min-w-max">
                        <!-- Header Row -->
                        <div class="font-bold p-2 bg-purple-200 text-purple-900 rounded-tl-lg">ประเภทงานหลัก</div>
                        <div class="font-bold p-2 bg-purple-100 text-purple-800">เครื่องมือแนะนำ</div>
                        <div class="font-bold p-2 bg-purple-100 text-purple-800 rounded-tr-lg">จุดเด่น</div>

                        <!-- Row 1: App Development -->
                        <div class="p-2 bg-white font-semibold flex items-center border-l border-b border-purple-300"><script>document.write(renderIcon('blocks', 'w-4 h-4 mr-2'));</script> สร้าง Web/Mobile App</div>
                        <div class="p-2 bg-white border-b border-purple-300 font-bold text-green-700">AppSheet</div>
                        <div class="p-2 bg-white border-b border-purple-300 text-xs">UI/UX, Data Forms, CRUD (ใช้ GGS เป็น Data Source)</div>

                        <!-- Row 2: Workflow Automation -->
                        <div class="p-2 bg-white font-semibold flex items-center border-l border-b border-purple-300"><script>document.write(renderIcon('git-branch', 'w-4 h-4 mr-2'));</script> เชื่อมต่อ/ทำงานอัตโนมัติ</div>
                        <div class="p-2 bg-white border-b border-purple-300 font-bold text-indigo-700">N8N, GAS</div>
                        <div class="p-2 bg-white border-b border-purple-300 text-xs">API Integration, Scheduling, Logic (เน้น Data Transformation)</div>
                        
                        <!-- Row 3: Data Source -->
                        <div class="p-2 bg-white font-semibold flex items-center border-l border-b border-purple-300 rounded-bl-lg"><script>document.write(renderIcon('database', 'w-4 h-4 mr-2'));</script> จัดการฐานข้อมูลหลัก</div>
                        <div class="p-2 bg-white border-b border-purple-300 font-bold text-red-700">Google Sheets (GGS)</div>
                        <div class="p-2 bg-white border-b border-purple-300 rounded-br-lg text-xs">Storage, Flexibility, Collaboration (ศูนย์กลางข้อมูล)</div>
                    </div>
                </div>
                <!-- END CSS DIAGRAM -->

                <div class="space-y-4 text-gray-600">
                    <h5 class="font-bold text-lg text-gray-700 mt-6 border-b pb-1">1.2.1 เกณฑ์การพิจารณาเลือกแพลตฟอร์ม:</h5>
                    <p class="ml-4">
                        การตัดสินใจเลือกเครื่องมือใน Ecosystem นี้ขึ้นอยู่กับ **"ฟังก์ชันหลัก"** ที่ต้องการ:
                        <ul class="list-disc list-inside ml-6">
                            <li>หากเน้น **การโต้ตอบของผู้ใช้ (Front-end/UI)** และการจัดการข้อมูลพื้นฐาน $\to$ เลือก **AppSheet** (No-Code App).</li>
                            <li>หากเน้น **Logic การประมวลผล (Back-end)**, การเชื่อมต่อกับหลาย API, หรือการตั้งเวลาทำงาน $\to$ เลือก **n8n** (Low-Code Workflow) หรือ **GAS** (Custom Low-Code Script).</li>
                            <li>**Google Sheets** เป็นหัวใจหลักของข้อมูลที่ทุกเครื่องมือจะมาเชื่อมต่อกัน.</li>
                        </ul>
                    </p>
                    
                    <h5 class="font-bold text-lg text-gray-700 border-b pb-1 mt-6">1.2.2 การวิเคราะห์ความซับซ้อนของ Logic และ Data Flow</h5>
                    <p class="ml-4">
                        <span class="font-bold text-purple-700">Flow A: Simple CRUD (Create, Read, Update, Delete):</span>
                        <ul class="list-disc list-inside ml-6">
                            <li>**Logic:** น้อย, เน้นการบันทึก/แสดงผลข้อมูลโดยตรง</li>
                            <li>**เครื่องมือที่เหมาะสม:** AppSheet (ใช้ Actions และ Bot พื้นฐาน)</li>
                        </ul>
                    </p>
                    <p class="ml-4">
                        <span class="font-bold text-indigo-700">Flow B: Complex Integration & Transformation:</span>
                        <ul class="list-disc list-inside ml-6">
                            <li>**Logic:** สูง, มีการประมวลผลเงื่อนไข (Conditional Logic), การแปลงข้อมูล (Mapping), การเรียก API หลายครั้ง</li>
                            <li>**เครื่องมือที่เหมาะสม:** n8n หรือ GAS (n8n จะดีกว่าสำหรับ API Flow เพราะมี Visual Workflow)</li>
                        </ul>
                    </p>
                    
                    <h5 class="font-bold text-lg text-gray-700 border-b pb-1 mt-6">1.2.3 Workshop: วิเคราะห์สถานการณ์จริง (3 เคส)</h5>
                    <p class="ml-4">
                        <span class="font-bold text-purple-700">วิธีทำ:</span> ผู้เรียนแต่ละคนจะได้รับโจทย์ 3 สถานการณ์ (เช่น ระบบแจ้งซ่อม, ระบบอนุมัติเอกสาร, ระบบดึงราคาจากเว็บไซต์) จากนั้นให้ใช้ตาราง Matrix ด้านบนในการวิเคราะห์ว่าควรใช้ **AppSheet**, **n8n**, หรือ **GAS** เป็นเครื่องมือหลักในการแก้ปัญหา พร้อมอธิบายเหตุผล.
                    </p>
                    <p class="ml-4">
                        **ตัวอย่างโจทย์วิเคราะห์:** <br>
                        <span class="font-bold">Case C:</span> สร้างระบบที่ผู้บริหารสามารถ "อนุมัติ" หรือ "ปฏิเสธ" เอกสารผ่านปุ่มใน Line $\to$ **Logic ซับซ้อน (n8n/GAS)** เพราะเกี่ยวข้องกับการรับ Webhook จาก Line และอัปเดต Status กลับไปที่ GGS
                    </p>
                    
                </div>

                <div class="mt-3 text-sm text-gray-500 italic flex items-center">
                    <script>document.write(renderIcon('tool', 'w-4 h-4 mr-2 text-purple-500'));</script> จุดเน้น: ทำความเข้าใจข้อจำกัดและขีดความสามารถของเครื่องมือหลัก.
                </div>
            </div>
            
            <!-- Step 1.3 -->
            <div class="step-card bg-white p-5 rounded-lg shadow-md">
                <div class="flex justify-between items-start mb-2">
                    <span class="text-lg font-bold text-gray-800">11:15 - 12:00 (0.75 ชม.): สรุป & Q&A / บทนำ Data Design</span>
                    <span class="text-xs font-medium text-green-500 bg-green-100 px-2 py-1 rounded-full">สรุป & เตรียมตัว</span>
                </div>
                <p class="text-gray-600">สรุปแนวคิดหลักของช่วงเช้า (ปรัชญา No-Code/Low-Code) และเข้าสู่บทนำของ **Data Design** เพื่อเตรียมพร้อมสำหรับช่วงบ่ายที่เน้นการปฏิบัติ</p>
            </div>
        </div>
        
        <!-- Divider for Lunch -->
        <div class="my-8 text-center">
            <span class="inline-flex items-center justify-center p-3 rounded-full bg-red-100 text-red-600 font-bold">
                <script>document.write(renderIcon('utensils', 'w-5 h-5 mr-2'));</script> พักกลางวัน (12:00 - 13:00 น.)
            </span>
        </div>

        <!-- Section 2: Data Design (13:00 - 17:00) -->
        <div class="mb-8">
            <div class="flex items-center mb-4 p-3 bg-blue-50 rounded-lg">
                <script>document.write(renderIcon('database', 'w-6 h-6 text-indigo-500 mr-3'));</script>
                <h4 class="text-xl font-semibold text-blue-800">ช่วงบ่าย: การออกแบบข้อมูลที่ยืดหยุ่นและการประยุกต์ใช้ Low-Code (3.25 ชม.)</h4>
            </div>

            <!-- Step 2.1: ทฤษฎีฐานข้อมูลสำหรับ No-Code -->
            <div class="step-card bg-white p-5 rounded-lg shadow-md mb-4">
                <div class="flex justify-between items-start mb-2">
                    <span class="text-lg font-bold text-gray-800">13:00 - 14:00 (1 ชม.): ทฤษฎีฐานข้อมูลสำหรับ No-Code</span>
                    <span class="text-xs font-medium text-teal-500 bg-teal-100 px-2 py-1 rounded-full">ทฤษฎี & โครงสร้าง</span>
                </div>
                <p class="font-semibold text-gray-700 mb-4">หัวข้อหลัก: Normalization เบื้องต้นและการเชื่อมโยงข้อมูลใน Google Sheets</p>
                
                <!-- START CSS DIAGRAM: Data Relationship (1-to-Many) -->
                <div class="my-4 p-5 bg-gray-50 rounded-lg border border-teal-200 shadow-inner">
                    <p class="text-sm font-semibold text-gray-700 mb-3 text-center">ภาพที่ 2.1: โครงสร้างความสัมพันธ์ข้อมูลแบบ 1-ต่อ-กลุ่ม (1-to-Many)</p>
                    <div class="flex flex-col sm:flex-row justify-center items-center space-y-4 sm:space-y-0 sm:space-x-6">
                        
                        <!-- Table 1: Customer -->
                        <div class="p-3 w-40 bg-teal-50 rounded-lg shadow-md border border-teal-400 text-center">
                            <p class="font-bold text-teal-800">Customers (GGS)</p>
                            <p class="text-xs text-gray-600">Primary Key (PK: ID)</p>
                        </div>

                        <!-- Relation 1 (Customer -> Sales) -->
                        <div class="flex flex-col items-center justify-center text-sm font-bold text-gray-500">
                            <script>document.write(renderIcon('arrow-down', 'w-4 h-4 text-gray-500 sm:hidden'));</script>
                            <span class="text-xs font-bold text-red-600">1 $\to$ Many</span>
                            <script>document.write(renderIcon('arrow-right', 'w-6 h-6 text-gray-500 hidden sm:block'));</script>
                        </div>

                        <!-- Table 2: Sales -->
                        <div class="p-3 w-40 bg-teal-50 rounded-lg shadow-md border border-teal-400 text-center">
                            <p class="font-bold text-teal-800">Sales Transactions (GGS)</p>
                            <p class="text-xs text-gray-600">Foreign Key (FK)</p>
                        </div>
                    </div>
                    <p class="text-xs text-center text-gray-500 mt-3">ตัวอย่างแสดง: 1 ลูกค้า สามารถมีรายการซื้อได้หลายรายการ</p>
                </div>
                <!-- END CSS DIAGRAM -->
                
                <div class="space-y-4 text-gray-600">
                    <h5 class="font-bold text-lg text-gray-700 mt-6 border-b pb-1">2.1.1 แนวคิดหลัก (Normalization 1NF, 2NF, 3NF):</h5>
                    <p class="ml-4">
                        <span class="font-bold text-teal-700">Normalization</span> คือกระบวนการจัดโครงสร้างข้อมูลให้มีประสิทธิภาพสูงสุด เพื่อให้มั่นใจว่าข้อมูลมีความถูกต้อง (Integrity) และลดความซ้ำซ้อน (Redundancy) ใน Google Sheets
                    </p>
                    <p class="ml-4">
                        **1st Normal Form (1NF):** กฎพื้นฐานที่สุด คือ **"Atomic Value"** ห้ามมีข้อมูลหลายค่าในเซลล์เดียว และห้ามมี Merged Cells (AppSheet จะไม่ทำงานถ้าไม่ผ่าน 1NF)
                    </p>
                    <p class="ml-4">
                        **2nd Normal Form (2NF):** ข้อมูลที่ไม่ขึ้นอยู่กับ Primary Key ทั้งหมด **ต้องถูกแยกออก** ตัวอย่าง: ถ้าในตาราง Sales Transactions มีคอลัมน์ Price of Product อยู่ ซึ่งจริงๆ แล้ว Price ขึ้นอยู่กับ Product ID ไม่ใช่ Transaction ID ทั้งหมด $\to$ ต้องแยก Price ไปอยู่ตาราง Products
                    </p>
                    <p class="ml-4">
                        **3rd Normal Form (3NF):** ข้อมูลที่ไม่ได้ขึ้นอยู่กับ Primary Key โดยตรง (Transitive Dependency) ต้องถูกแยกออก ตัวอย่าง: ถ้าในตาราง Customers มีคอลัมน์ Customer Type Description ซึ่งขึ้นอยู่กับ Customer Type Code อีกที $\to$ ต้องแยก Customer Type Code/Description ไปอยู่ตาราง Master
                    </p>
                    
                    <h5 class="font-bold text-lg text-gray-700 border-b pb-1 mt-6">2.1.2 ความสัมพันธ์ของข้อมูลและ Key (PK/FK) ใน AppSheet Ecosystem:</h5>
                    <p class="ml-4">
                        <span class="font-bold text-blue-700">Primary Key (PK):</span> เป็นหัวใจของตาราง **ต้องไม่ซ้ำและไม่เป็นค่าว่าง** การสร้าง PK ที่ดีที่สุดคือการใช้ **Unique ID Generator** (เช่น GAS Script ใน Workshop นี้ หรือฟังก์ชัน <span class="code-snippet">UNIQUEID()</span> ของ AppSheet)
                    </p>
                    <p class="ml-4">
                        <span class="font-bold text-red-700">Foreign Key (FK) และ Ref Type:</span> คอลัมน์ FK จะถูกกำหนดเป็นชนิดข้อมูล **'Ref'** ใน AppSheet ซึ่งช่วยให้ AppSheet สามารถสร้าง **Virtual Columns (Related Columns)** เพื่อดึงข้อมูลจากตาราง Master ที่เชื่อมโยงกันมาใช้งานได้ทันที (เช่น ดึงชื่อลูกค้าจากตาราง Customers มาแสดงในตาราง Sales Transactions)
                    </p>
                    
                    <h5 class="font-bold text-lg text-gray-700 border-b pb-1 mt-6">2.1.3 การเตรียม Data Source สำหรับ AppSheet/N8N (Advanced GGS Setup):</h5>
                    <p class="ml-4">
                        <span class="font-bold text-teal-700">ตารางเทียบ Data Type (GGS vs. AppSheet):</span>
                    </p>
                    <div class="border border-gray-300 rounded-lg overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-teal-50">
                                <tr>
                                    <th class="px-3 py-2 text-left text-xs font-bold text-teal-700 uppercase tracking-wider">GGS Format</th>
                                    <th class="px-3 py-2 text-left text-xs font-bold text-teal-700 uppercase tracking-wider">AppSheet Type ที่ถูกต้อง</th>
                                    <th class="px-3 py-2 text-left text-xs font-bold text-teal-700 uppercase tracking-wider">การใช้งานที่สำคัญ</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200 text-sm">
                                <tr>
                                    <td class="px-3 py-2 font-mono">Plain Text (ข้อความทั่วไป)</td>
                                    <td class="px-3 py-2">Text, Enum, Name</td>
                                    <td class="px-3 py-2">ใช้สำหรับคีย์ที่ไม่ใช่ PK (เช่น ชื่อลูกค้า, รายละเอียด)</td>
                                </tr>
                                <tr>
                                    <td class="px-3 py-2 font-mono">Date/Time Format</td>
                                    <td class="px-3 py-2">Date, Time, DateTime</td>
                                    <td class="px-3 py-2">AppSheet จะแปลงเป็น Timezone ที่เหมาะสมกับการใช้งาน</td>
                                </tr>
                                <tr>
                                    <td class="px-3 py-2 font-mono">Hyperlink (A1:A)</td>
                                    <td class="px-3 py-2">URL, Image, File</td>
                                    <td class="px-3 py-2">ใช้สำหรับลิงก์เอกสาร หรือ URL ของภาพที่ต้องการแสดง</td>
                                </tr>
                                <tr>
                                    <td class="px-3 py-2 font-mono">รหัสตัวเลขเฉพาะ</td>
                                    <td class="px-3 py-2 text-red-600 font-bold">Ref (Foreign Key)</td>
                                    <td class="px-3 py-2">ใช้สำหรับเชื่อมโยงไปยังตารางหลัก (Master Data) เท่านั้น</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <h5 class="font-bold text-lg text-gray-700 border-b pb-1 mt-6">2.1.4 การจัดการ Data Validation และ Virtual Tables:</h5>
                    <p class="ml-4">
                        <span class="font-bold text-teal-700">Data Validation:</span>
                        <p class="ml-4">การใช้ Data Validation ใน GGS เพื่อควบคุมการป้อนข้อมูลให้ถูกต้องก่อนเข้า AppSheet จะช่วยรักษาคุณภาพข้อมูลได้ดียิ่งขึ้น</p>
                        <ul class="list-disc list-inside ml-6">
                            <li>**List from a range:** ใช้ในการดึงข้อมูลจากตาราง Master (เช่น ดึงรายชื่อสินค้าจาก Sheet 'Products'!B2:B) มาเป็น Dropdown list ใน Sheet 'Sales Transactions'</li>
                            <li>**Custom Formula:** ใช้เพื่อบังคับให้ผู้ใช้กรอกข้อมูลตามเงื่อนไขที่กำหนด (เช่น ตัวเลขต้องมากกว่า 0, วันที่ไม่เป็นวันหยุด)</li>
                        </ul>
                    </p>
                    <p class="ml-4">
                        <span class="font-bold text-teal-700">Virtual Tables/Reports:</span>
                        <p class="ml-4">การใช้ฟังก์ชัน <span class="code-snippet">QUERY()</span> หรือ <span class="code-snippet">FILTER()</span> ใน GGS เพื่อรวมข้อมูลจากหลายตาราง/Sheet มาแสดงเป็น Report หรือ Dashboard โดยไม่ต้องยุ่งกับตารางต้นฉบับ</p>
                        <pre class="bg-gray-800 p-3 rounded-lg text-white text-xs overflow-x-auto my-2"><code><i class="text-gray-400">// ตัวอย่าง QUERY เพื่อดึงยอดขายเฉพาะลูกค้า VIP</i>
=QUERY(SalesTransactions!A:G, "SELECT B, D, SUM(E) WHERE F='VIP' GROUP BY B, D ORDER BY SUM(E) DESC", 1)</code></pre>
                    </p>
                </div>

                <div class="mt-3 text-sm text-gray-500 italic flex items-center">
                    <script>document.write(renderIcon('git-branch', 'w-4 h-4 mr-2 text-teal-500'));</script> จุดเน้น: การสร้างโครงสร้างข้อมูลที่ 'ยืดหยุ่น' และ 'สอดคล้อง' กับการทำงานของ Automation.
                </div>
            </div>

            <!-- Step 2.2: Workshop 1: AI-Driven GAS - Auto ID -->
            <div class="step-card bg-white p-5 rounded-lg shadow-md mb-4">
                <div class="flex justify-between items-start mb-2">
                    <span class="text-lg font-bold text-gray-800">14:00 - 14:45 (0.75 ชม.): Workshop 1: AI-Driven GAS Scripting (Auto Primary Key)</span>
                    <span class="text-xs font-medium text-orange-500 bg-orange-100 px-2 py-1 rounded-full">Workshop ปฏิบัติ / AI Prompt</span>
                </div>
                <p class="font-semibold text-gray-700 mb-4">หัวข้อหลัก: การใช้ AI (Gemini) ช่วยสร้างโค้ด Google App Script สำหรับ Auto Generate ID</p>
                
                <!-- START CSS DIAGRAM: Google Sheet Structure Mockup -->
                <div class="my-4 p-5 bg-gray-50 rounded-lg border border-orange-200 shadow-inner overflow-x-auto">
                    <p class="text-sm font-semibold text-gray-700 mb-3 text-center">ภาพที่ 2.2: การจัดโครงสร้าง Google Sheets เพื่อรองรับ AppSheet (Normalization)</p>
                    <div class="flex flex-wrap justify-center gap-6 min-w-max">
                        
                        <!-- Table 1: Customers -->
                        <div class="w-48 bg-white border border-gray-300 rounded-lg shadow-md">
                            <div class="p-2 bg-orange-200 font-bold text-sm text-orange-900 rounded-t-lg flex items-center">
                                <script>document.write(renderIcon('users', 'w-4 h-4 mr-2'));</script> Customers (GGS Sheet)
                            </div>
                            <ul class="p-2 text-xs text-gray-700 space-y-1">
                                <li class="font-bold text-blue-600">ID (PK)</li>
                                <li>Name</li>
                                <li>Email</li>
                            </ul>
                        </div>
                        <!-- ... (Other tables for visual consistency) ... -->
                    </div>
                </div>
                <!-- END CSS DIAGRAM -->

                <h5 class="font-bold text-lg text-gray-700 mt-6 border-b pb-1">ขั้นตอนการสร้าง Data Source และ GAS Hook:</h5>
                <ol class="list-decimal list-inside text-gray-600 space-y-3 ml-4">
                    <li>**เตรียม GGS:** สร้าง Google Sheet และ Sheet <span class="font-mono bg-gray-100 p-1 rounded">Customers</span></li>
                    <li>**เปิด Gemini เพื่อสร้างโค้ด:** เข้าถึงเครื่องมือ AI เพื่อช่วยเขียนโค้ด GAS</li>
                    <li>**คัดลอก Prompt:** ใช้ Prompt ที่สร้างขึ้นเพื่อควบคุม AI ให้สร้างโค้ด Auto ID ที่ต้องการ</li>
                </ol>

                <h5 class="font-bold text-lg text-red-700 mt-6 border-b pb-1 flex items-center">
                    <script>document.write(renderIcon('brain', 'w-5 h-5 mr-2 text-red-700'));</script> Prompt Template 1: Generate Auto ID GAS Script
                </h5>
                <div class="my-4 p-4 bg-red-50 border border-red-300 rounded-lg shadow-inner">
                    <h6 class="font-bold text-red-800 mb-2">Prompt ที่ใช้สร้างโค้ด Auto ID</h6>
                    <pre class="bg-white p-3 rounded-lg text-gray-800 text-xs overflow-x-auto"><code><span class="font-bold text-blue-600">1. Role & Task:</span> "Act as a Google Apps Script expert. Write a complete GAS script."
<span class="font-bold text-blue-600">2. Context (Environment):</span> "The script must run using the 'onEdit' simple trigger in Google Sheets."
<span class="font-bold text-blue-600">3. Requirements (Logic):</span> "The script needs to target the sheet named 'Customers' (Case-sensitive). If a new row is added, and Column A (index 1) is empty, automatically generate a unique ID. The ID must start with 'CUST-' followed by a timestamp (YYMMDD-HHMMSS) and a 4-digit random hex string."
<span class="font-bold text-blue-600">4. Output Format:</span> "Provide only the executable code, clearly commented in English."</code></pre>
                </div>

                <h5 class="font-bold text-lg text-gray-700 mt-6 border-b pb-1">Code Output: Google App Script สำหรับ Auto ID (โค้ดที่ได้จาก AI)</h5>
                <p class="ml-4 text-sm text-red-600 font-semibold">
                    (คัดลอกโค้ดนี้ไปวางใน Extensions > App Script)
                </p>
                
                <pre class="bg-gray-800 p-4 rounded-lg text-white text-sm overflow-x-auto"><code><i class="text-gray-400">// ชื่อไฟล์: AutoIDGenerator.gs</i>
<i class="text-gray-400">// คำอธิบาย: ฟังก์ชันหลักที่ทำงานเมื่อมีการแก้ไขข้อมูลใน Google Sheet (Trigger 'On Edit')</i>

function onEdit(e) {
  <i class="text-gray-400">// 1. ดึงข้อมูล Event Object ที่เกิดขึ้นจากการแก้ไข</i>
  const range = e.range; 
  const sheet = range.getSheet(); 
  const sheetName = sheet.getName(); 
  
  <i class="text-gray-400">// 2. กำหนดค่าคงที่ที่จำเป็น</i>
  const TARGET_SHEET_NAME = 'Customers'; 
  const ID_COLUMN_INDEX = 1; 
  const FIRST_DATA_ROW = 2; 

  <i class="text-gray-400">// 3. ตรวจสอบเงื่อนไขการทำงาน (Guard Clauses)</i>
  if (sheetName !== TARGET_SHEET_NAME || range.getRow() < FIRST_DATA_ROW) {
    return; 
  }
  
  <i class="text-gray-400">// 4. ตรวจสอบว่า ID ได้ถูกสร้างไปแล้วหรือไม่</i>
  const idCell = sheet.getRange(range.getRow(), ID_COLUMN_INDEX);
  if (idCell.getValue() !== "") {
    return;
  }

  <i class="text-gray-400">// 5. สร้าง ID ใหม่และบันทึกลงในเซลล์</i>
  const newId = generateUniqueId('CUST-');
  idCell.setValue(newId);
}

<i class="text-gray-400">// ฟังก์ชันช่วยในการสร้าง Unique ID</i>
function generateUniqueId(prefix) {
  <i class="text-gray-400">// รูปแบบ ID: PREFIX-YYMMDD-HHMMSS-RANDOM_HEX</i>
  const now = new Date();
  const year = now.getFullYear().toString().substring(2);
  const month = String(now.getMonth() + 1).padStart(2, '0');
  const day = String(now.getDate()).padStart(2, '0');
  const hours = String(now.getHours()).padStart(2, '0');
  const minutes = String(now.getMinutes()).padStart(2, '0');
  const seconds = String(now.getSeconds()).padStart(2, '0');

  <i class="text-gray-400">// ส่วน Random String</i>
  const randomHex = Math.random().toString(16).substring(2, 6).toUpperCase(); 

  const timestamp = `${year}${month}${day}-${hours}${minutes}${seconds}`;
  return `${prefix}${timestamp}-${randomHex}`;
}

<i class="text-gray-400">// **** ส่วนเสริม: ฟังก์ชันสำหรับ Debugging ****</i>

function debugLogCustomerSheet() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();
  const sheet = ss.getSheetByName('Customers');
  if (!sheet) {
    Logger.log("Sheet 'Customers' not found.");
    return;
  }
  const data = sheet.getRange('A1:C5').getValues();
  Logger.log("Customer Sheet Data (A1:C5):");
  data.forEach((row, index) => {
    Logger.log(`Row ${index + 1}: ${row.join(' | ')}`);
  });
}</code></pre>
                
                <h5 class="font-bold text-lg text-gray-700 mt-6 border-b pb-1">การตั้งค่า Trigger ใน GAS (Low-Code Integration):</h5>
                <p class="ml-4">รายละเอียดตามขั้นตอนที่ 1-5 ด้านล่าง:</p>
                <ol class="list-decimal list-inside text-gray-600 space-y-3 ml-4">
                    <li>ใน GAS IDE, ให้คลิกที่ไอคอนนาฬิกา (Triggers) ทางด้านซ้าย</li>
                    <li>คลิก **Add Trigger**</li>
                    <li>**Choose which function to run:** เลือก <span class="font-mono bg-gray-100 p-1 rounded">onEdit</span></li>
                    <li>**Choose event source:** เลือก <span class="font-mono bg-gray-100 p-1 rounded">From spreadsheet</span></li>
                    <li>**Choose event type:** เลือก <span class="font-mono bg-gray-100 p-1 rounded">On edit</span></li>
                    <li>**Save:** บันทึก Trigger นี้เพื่อให้โค้ดทำงานอัตโนมัติเมื่อมีการเพิ่มข้อมูลลูกค้าใน Google Sheet</li>
                </ol>
            </div>

            <!-- Divider for Afternoon Break -->
            <div class="my-6 text-center">
                <span class="inline-flex items-center justify-center p-3 rounded-full bg-yellow-100 text-yellow-600 font-bold">
                    <script>document.write(renderIcon('coffee', 'w-5 h-5 mr-2'));</script> เบรคบ่าย (14:45 - 15:00 น.)
                </span>
            </div>

            <!-- Step 2.3: Workshop 2: AI-Driven GAS - Email Notification -->
            <div class="step-card bg-white p-5 rounded-lg shadow-md mb-4">
                <div class="flex justify-between items-start mb-2">
                    <span class="text-lg font-bold text-gray-800">15:00 - 15:30 (0.5 ชม.): Workshop 2: AI-Driven GAS Scripting (Email Notification)</span>
                    <span class="text-xs font-medium text-red-500 bg-red-100 px-2 py-1 rounded-full">Automation Core / AI Prompt</span>
                </div>
                <p class="font-semibold text-gray-700 mb-4">หัวข้อหลัก: การใช้ AI สร้างโค้ดสำหรับส่งอีเมลสรุปข้อมูลการขายเมื่อเกิด Transaction ใหม่</p>

                <h5 class="font-bold text-lg text-red-700 mt-6 border-b pb-1 flex items-center">
                    <script>document.write(renderIcon('brain', 'w-5 h-5 mr-2 text-red-700'));</script> Prompt Template 2: Generate Email Notification Script
                </h5>
                <p class="ml-4 text-sm text-gray-700 font-semibold italic">
                    ในการทำ Automation สิ่งที่ขาดไม่ได้คือการแจ้งเตือน (Notification) เราจะใช้ AI สร้างฟังก์ชันที่ส่งอีเมลสรุปยอดขายเมื่อมีการบันทึกข้อมูลใน Sheet 'Sales Transactions'
                </p>
                
                <div class="my-4 p-4 bg-red-50 border border-red-300 rounded-lg shadow-inner">
                    <h6 class="font-bold text-red-800 mb-2">Prompt ที่ใช้สร้างโค้ด Email Notification</h6>
                    <pre class="bg-white p-3 rounded-lg text-gray-800 text-xs overflow-x-auto"><code><span class="font-bold text-blue-600">1. Role & Task:</span> "Act as a Google Apps Script expert. Write a complete GAS script."
<span class="font-bold text-blue-600">2. Context (Environment):</span> "The script must run using the 'onEdit' simple trigger. The target sheet is 'Sales Transactions'. The data columns are: A (Transaction ID), B (Customer ID), C (Product ID), D (Quantity), E (Date). Column B and C are FKs that reference other sheets."
<span class="font-bold text-blue-600">3. Requirements (Logic):</span> "When a new row is added (Row > 1), read the data from the last row. Send an email to 'admin@example.com' with the subject 'New Sales Alert: [Transaction ID]'. The email body must contain a summary of the Customer ID, Product ID, and Quantity. Only send if Column A is NOT empty (meaning Auto ID has been generated)."
<span class="font-bold text-blue-600">4. Output Format:</span> "Provide only the executable code, clearly commented in English."</code></pre>
                </div>
                
                <h5 class="font-bold text-lg text-gray-700 mt-6 border-b pb-1">Code Output: GAS Script สำหรับ Email Notification (โค้ดที่ได้จาก AI)</h5>
                <pre class="bg-gray-800 p-4 rounded-lg text-white text-sm overflow-x-auto"><code><i class="text-gray-400">// ชื่อไฟล์: EmailNotifier.gs</i>
<i class="text-gray-400">// คำอธิบาย: ฟังก์ชันสำหรับส่งอีเมลแจ้งเตือนเมื่อมีการบันทึกข้อมูลการขายใหม่</i>

function sendNewSaleNotification(e) {
  try {
    const range = e.range;
    const sheet = range.getSheet();
    const sheetName = sheet.getName();

    <i class="text-gray-400">// กำหนด Sheet เป้าหมายและแถวเริ่มต้น</i>
    const TARGET_SHEET_NAME = 'Sales Transactions';
    const FIRST_DATA_ROW = 2;
    const TRANSACTION_ID_COL_INDEX = 1; <i class="text-gray-400">// คอลัมน์ A (Transaction ID)</i>
    const LAST_COLUMN = 5; <i class="text-gray-400">// คอลัมน์ E (Date)</i>

    <i class="text-gray-400">// 1. ตรวจสอบเงื่อนไขการทำงาน</i>
    if (sheetName !== TARGET_SHEET_NAME || range.getRow() < FIRST_DATA_ROW) {
      return;
    }
    
    <i class="text-gray-400">// 2. ดึงข้อมูลจากแถวที่ถูกแก้ไขล่าสุด</i>
    const row = range.getRow();
    <i class="text-gray-400">// ดึงข้อมูลตั้งแต่คอลัมน์ A ถึงคอลัมน์สุดท้ายที่มีข้อมูล (E)</i>
    const dataRange = sheet.getRange(row, 1, 1, LAST_COLUMN);
    const data = dataRange.getValues()[0]; 

    <i class="text-gray-400">// 3. ตรวจสอบว่า Transaction ID ถูกสร้างแล้วหรือไม่ (Data Integrity Check)</i>
    const transactionId = data[TRANSACTION_ID_COL_INDEX - 1]; 
    if (!transactionId || transactionId.trim() === "") {
      <i class="text-gray-400">// หาก ID ยังไม่ถูกสร้าง (อาจต้องรอ Auto ID Script ทำงาน) ให้หยุด</i>
      Logger.log(`Transaction ID missing in row ${row}. Skipping notification.`);
      return;
    }

    <i class="text-gray-400">// 4. เตรียมข้อมูลอีเมล</i>
    const customerId = data[1]; <i class="text-gray-400">// Customer ID (Column B)</i>
    const productId = data[2]; <i class="text-gray-400">// Product ID (Column C)</i>
    const quantity = data[3]; <i class="text-gray-400">// Quantity (Column D)</i>
    
    const recipient = 'admin@example.com';
    const subject = `[ระบบแจ้งเตือน] New Sales Alert: ${transactionId}`;
    const body = `เรียน Admin,\n\nมีการบันทึกรายการขายใหม่ในระบบ:\n\n`
          + `Transaction ID: ${transactionId}\n`
          + `Customer ID: ${customerId}\n`
          + `Product ID: ${productId}\n`
          + `Quantity: ${quantity}\n\n`
          + `โปรดตรวจสอบที่ Google Sheet.\n\n`
          + `AI Automation System.`;

    <i class="text-gray-400">// 5. ส่งอีเมล</i>
    MailApp.sendEmail(recipient, subject, body);
    Logger.log(`Email sent successfully for Transaction ID: ${transactionId}`);

  } catch (error) {
    <i class="text-gray-400">// การจัดการข้อผิดพลาดระดับมืออาชีพ</i>
    Logger.log(`ERROR in sendNewSaleNotification: ${error.toString()}`);
    MailApp.sendEmail('it-support@example.com', 'GAS Error Alert', 
              `เกิดข้อผิดพลาดในการส่งอีเมลแจ้งเตือนการขาย: ${error.toString()}`);
  }
}

<i class="text-gray-400">// **ข้อควรระวัง:** ต้องตั้งค่า Trigger ให้รันฟังก์ชันนี้ 'On Edit' ด้วย</i>
<i class="text-gray-400">// และตรวจสอบลำดับการทำงานร่วมกับ Auto ID Script</i></code></pre>

                <h5 class="font-bold text-lg text-gray-700 mt-6 border-b pb-1">การตั้งค่า Trigger (Notification):</h5>
                <p class="ml-4">ใช้ขั้นตอนการตั้งค่า Trigger **แบบเดียวกับ Workshop 1** แต่เปลี่ยนฟังก์ชันที่รันเป็น <span class="font-mono bg-gray-100 p-1 rounded">sendNewSaleNotification</span> และตั้งค่า Source เป็น Sheet **'Sales Transactions'** แทน Sheet 'Customers'</p>
                <div class="mt-3 text-sm text-gray-500 italic flex items-center">
                    <script>document.write(renderIcon('mail', 'w-4 h-4 mr-2 text-red-500'));</script> จุดเน้น: การทำ Logic ที่ทำงานต่อเนื่อง (Sequential Logic) โดยใช้ผลลัพธ์จาก GAS Script หนึ่ง ไป Trigger การทำงานของ GAS Script อีกตัว (หรือ AppSheet Bot)
                </div>
            </div>

            <!-- Step 2.4: Workshop 3: AI-Driven GAS - Data Lookup and Advanced Stability (NEW) -->
            <div class="step-card bg-white p-5 rounded-lg shadow-md">
                <div class="flex justify-between items-start mb-2">
                    <span class="text-lg font-bold text-gray-800">15:30 - 16:00 (0.5 ชม.): Workshop 3: AI-Driven GAS (Data Lookup & Advanced Stability)</span>
                    <span class="text-xs font-medium text-indigo-500 bg-indigo-100 px-2 py-1 rounded-full">Advanced Low-Code / AI Prompt</span>
                </div>
                <p class="font-semibold text-gray-700 mb-4">หัวข้อหลัก: การใช้ AI สร้างโค้ดสำหรับดึงชื่อสินค้าและราคาสินค้าจากตาราง Master มาคำนวณราคารวม (Total Price) ในตาราง Transaction</p>
                
                <h5 class="font-bold text-lg text-red-700 mt-6 border-b pb-1 flex items-center">
                    <script>document.write(renderIcon('brain', 'w-5 h-5 mr-2 text-red-700'));</script> Prompt Template 3: Generate Lookup and Calculation Script
                </h5>
                <p class="ml-4 text-sm text-gray-700 font-semibold italic">
                    การทำ Data Lookup (VLOOKUP-like) ใน GAS เป็นเรื่องซับซ้อน เราจะใช้ AI สร้างฟังก์ชันที่อ่าน Product ID และดึง Price มาคำนวณ Total Price และบันทึกกลับลงใน GGS
                </p>
                
                <div class="my-4 p-4 bg-red-50 border border-red-300 rounded-lg shadow-inner">
                    <h6 class="font-bold text-red-800 mb-2">Prompt ที่ใช้สร้างโค้ด Data Lookup และ Calculation</h6>
                    <pre class="bg-white p-3 rounded-lg text-gray-800 text-xs overflow-x-auto"><code><span class="font-bold text-blue-600">1. Role & Task:</span> "Act as a Google Apps Script expert. Write a complete GAS script."
<span class="font-bold text-blue-600">2. Context (Environment):</span> "The script must run using the 'onEdit' simple trigger. The target sheet is 'Sales Transactions'. Column C is Product ID and Column D is Quantity. The Master Data is in the 'Products' sheet, where Column A is Product ID and Column C is Price."
<span class="font-bold text-blue-600">3. Requirements (Logic):</span> "When Quantity (Column D) is edited in 'Sales Transactions', the script must read the Product ID from Column C of the same row. Use this ID to find the Price in the 'Products' sheet. Calculate Total Price (Quantity * Price) and write the result to Column F (index 6) of the 'Sales Transactions' row."
<span class="font-bold text-blue-600">4. Output Format:</span> "Provide only the executable code, clearly commented in English, and use try/catch for robust error handling."</code></pre>
                </div>
                
                <h5 class="font-bold text-lg text-gray-700 mt-6 border-b pb-1">Code Output: GAS Script สำหรับ Data Lookup & Transformation (โค้ดที่ได้จาก AI)</h5>
                <pre class="bg-gray-800 p-4 rounded-lg text-white text-sm overflow-x-auto"><code><i class="text-gray-400">// ชื่อไฟล์: DataLookupAndCalc.gs</i>
<i class="text-gray-400">// คำอธิบาย: ฟังก์ชัน VLOOKUP เสมือนและคำนวณราคารวม</i>

function calculateTotalPrice(e) {
  const TARGET_SHEET_NAME = 'Sales Transactions';
  const QUANTITY_COL_INDEX = 4; <i class="text-gray-400">// คอลัมน์ D</i>
  const PRODUCT_ID_COL_INDEX = 3; <i class="text-gray-400">// คอลัมน์ C</i>
  const TOTAL_PRICE_COL_INDEX = 6; <i class="text-gray-400">// คอลัมน์ F</i>
  const FIRST_DATA_ROW = 2;

  const range = e.range;
  const sheet = range.getSheet();
  const sheetName = sheet.getName();
  
  <i class="text-gray-400">// 1. ตรวจสอบเงื่อนไขการทำงาน (Edited sheet and Quantity column)</i>
  if (sheetName !== TARGET_SHEET_NAME || range.getColumn() !== QUANTITY_COL_INDEX || range.getRow() < FIRST_DATA_ROW) {
    return;
  }

  try {
    const row = range.getRow();
    const productId = sheet.getRange(row, PRODUCT_ID_COL_INDEX).getValue();
    const quantity = range.getValue();

    if (!productId || typeof quantity !== 'number' || quantity <= 0) {
      sheet.getRange(row, TOTAL_PRICE_COL_INDEX).setValue("Input Error");
      return;
    }

    <i class="text-gray-400">// 2. ดึงข้อมูลตาราง Products (Master Data)</i>
    const ss = SpreadsheetApp.getActiveSpreadsheet();
    const productSheet = ss.getSheetByName('Products');
    if (!productSheet) throw new Error("Sheet 'Products' not found.");
    
    <i class="text-gray-400">// ดึงข้อมูลทั้งหมดในตาราง Products (A:C)</i>
    const productData = productSheet.getRange('A:C').getValues();

    <i class="text-gray-400">// 3. ทำการ Lookup (VLOOKUP เสมือน)</i>
    let price = 0;
    for (let i = 1; i < productData.length; i++) {
      <i class="text-gray-400">// A = Product ID (Index 0), C = Price (Index 2)</i>
      if (productData[i][0] == productId) {
        price = productData[i][2]; 
        break;
      }
    }
    
    if (price === 0) {
      sheet.getRange(row, TOTAL_PRICE_COL_INDEX).setValue("Product Not Found");
      return;
    }

    <i class="text-gray-400">// 4. คำนวณและบันทึกผลลัพธ์</i>
    const totalPrice = quantity * price;
    sheet.getRange(row, TOTAL_PRICE_COL_INDEX).setValue(totalPrice);
    
  } catch (error) {
    Logger.log(`[FATAL ERROR] Calculation Failed: ${error.toString()}`);
    sheet.getRange(range.getRow(), TOTAL_PRICE_COL_INDEX).setValue("System Error");
  }
}</code></pre>

                <h5 class="font-bold text-lg text-gray-700 mt-6 border-b pb-1 flex items-center">
                    <script>document.write(renderIcon('alert-triangle', 'w-5 h-5 mr-2 text-yellow-500'));</script> Advanced Low-Code Stability: Lock Service และ Error Handling
                </h5>
                <p class="ml-4 text-sm text-gray-700 font-semibold italic">
                    เมื่อ Logic ซับซ้อนขึ้น ความเสถียรของโค้ดเป็นสิ่งสำคัญที่สุด เราต้องใช้เครื่องมือเหล่านี้เพื่อให้แน่ใจว่าระบบจะไม่ล่มเมื่อมีผู้ใช้พร้อมกันหลายคน
                </p>

                <h6 class="font-bold text-red-800 mt-3">การจัดการ Race Condition ด้วย Lock Service</h6>
                <p class="ml-4 text-sm text-gray-600">
                    เนื่องจากฟังก์ชัน <span class="font-mono bg-gray-100 p-1 rounded">onEdit</span> ของ GAS ถูกเรียกใช้พร้อมกันได้เมื่อมีผู้ใช้แก้ไขข้อมูลพร้อมกันหลายคน การใช้ **Lock Service** จึงจำเป็นเพื่อ "ล็อก" การเข้าถึง Spreadsheet ชั่วคราวในช่วงเวลาที่ Script กำลังทำงานสำคัญ (เช่น การสร้าง ID หรือการ Lookup ข้อมูล)
                </p>
                <pre class="bg-gray-800 p-4 rounded-lg text-white text-sm overflow-x-auto"><code><i class="text-gray-400">// ตัวอย่าง: โค้ดทั้งหมดต้องอยู่ภายใน Block Lock นี้</i>

function functionWithLock(e) {
  const lock = LockService.getScriptLock();
  try {
    <i class="text-gray-400">// กำหนดเวลาสูงสุดที่ Script จะรอ Lock (30 วินาที)</i>
    const lockObtained = lock.tryLock(30000); 

    if (!lockObtained) {
      Logger.log("Could not obtain lock within 30 seconds. Skipping process.");
      return;
    }

    <i class="text-gray-400">// **วางโค้ด AutoID หรือ calculateTotalPrice ไว้ใน Block นี้**</i>
    <i class="text-gray-400">// ... (โค้ดหลักของคุณ) ...</i>

    <i class="text-gray-400">// ปลด Lock เมื่อทำงานเสร็จ</i>
    lock.releaseLock(); 

  } catch (error) {
    <i class="text-gray-400">// จัดการข้อผิดพลาด</i>
    Logger.log(`Critical Error during execution: ${error.toString()}`);
  }
}</code></pre>
                
                <h6 class="font-bold text-red-800 mt-3">การจัดการข้อผิดพลาดด้วย Try...Catch</h6>
                <p class="ml-4 text-sm text-gray-600">
                    การใช้ <span class="font-mono bg-gray-100 p-1 rounded">try...catch</span> ในฟังก์ชันหลักทั้งหมดเป็นมาตรฐาน **Senior Developer** เพื่อดักจับข้อผิดพลาดที่ไม่คาดคิด (เช่น Sheet ถูกลบ หรือ API ล่ม) และบันทึกข้อผิดพลาดนั้นใน **Logger.log** หรือส่งอีเมลแจ้งเตือนไปยังทีมซัพพอร์ตโดยอัตโนมัติ (ดังตัวอย่างใน Workshop 2)
                </p>
                <p class="ml-4 text-sm text-gray-600">
                    **เทคนิคการ Debugging ขั้นสูง:**
                    <ul class="list-disc list-inside ml-6 text-xs mt-2">
                        <li>**Logger.log():** ใช้เพื่อตรวจสอบค่าตัวแปรและ Flow การทำงานในระหว่างการพัฒนาและทดสอบ (Testing).</li>
                        <li>**Execution Log:** ตรวจสอบเมนู Execution Log ใน GAS IDE เพื่อดูว่า Script ทำงานสำเร็จหรือไม่ หากล้มเหลว จะแสดงหมายเลขแถว (Line Number) ที่มีปัญหา.</li>
                        <li>**Error Alert Email:** การเพิ่ม <span class="font-mono bg-gray-100 p-1 rounded">MailApp.sendEmail()</span> ใน Block <span class="font-mono bg-gray-100 p-1 rounded">catch</span> ช่วยให้ทีม IT ทราบถึงปัญหาทันทีโดยไม่ต้องเฝ้า Log.</li>
                        <li>**Debugging Breakpoints:** ใช้เครื่องมือ Debugger ใน GAS IDE เพื่อหยุดโค้ดชั่วคราวและตรวจสอบค่าของตัวแปรในแต่ละขั้นตอน (Step-by-Step Execution).</li>
                    </ul>
                </p>
                
                <h5 class="font-bold text-lg text-gray-700 mt-6 border-b pb-1">สรุปการตั้งค่า:</h5>
                <p class="ml-4">
                    ฟังก์ชัน <span class="font-mono bg-gray-100 p-1 rounded">calculateTotalPrice</span> ต้องถูกตั้ง Trigger **On Edit** บน Sheet **'Sales Transactions'** เพื่อให้ Logic การคำนวณและการแจ้งเตือนทำงานได้ทันที
                </p>

                <div class="mt-3 text-sm text-gray-500 italic flex items-center">
                    <script>document.write(renderIcon('shield', 'w-4 h-4 mr-2 text-indigo-500'));</script> จุดเน้น: การสร้าง Low-Code Script ที่ไม่ใช่แค่ "ทำงานได้" แต่ต้อง "ทำงานได้อย่างเสถียรและปลอดภัย" ในสภาพแวดล้อม Multi-User
                </div>
            </div>
        </div>
        
        <!-- *************************************************************** -->
        <!-- ********************* END ORIGINAL CONTENT ********************** -->
        <!-- *************************************************************** -->

    </main>

    <!-- Footer Section (Consistent with Day 2) -->
    <footer class="bg-gray-800 text-white py-6 mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p>&copy; 2025 AI Automation & Data Integration Master. | เอกสารประกอบการสอนโดย อ.แทน [ธีรชัย โฉมทัพ]</p>
            <p class="text-sm text-gray-400 mt-1">Head of Digital Transformation</p>
        </div>
    </footer>

</body>
</html>
